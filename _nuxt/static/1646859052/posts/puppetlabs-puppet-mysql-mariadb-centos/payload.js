__NUXT_JSONP__("/posts/puppetlabs-puppet-mysql-mariadb-centos", (function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B){return {data:[{post:{slug:"puppetlabs-puppet-mysql-mariadb-centos",description:"Making the puppetlabs-mysql official Puppet module work with the official MariaDB CentOS repositories.",title:"Official Puppet Mysql & MariaDB on CentOS",imagesource:"https:\u002F\u002Fwww.flickr.com\u002Fphotos\u002Feschipul\u002F5047874345\u002F",imagecredit:"Ed Schipul",image:"2015.07.12T06:00:00_puppetlabs-puppet-mysql-mariadb-centos.png",createdAt:w,updatedAt:w,toc:[],body:{type:"root",children:[{type:b,tag:m,props:{},children:[{type:a,value:"Hi all,"}]},{type:a,value:h},{type:b,tag:m,props:{},children:[{type:a,value:"Today, I'm going to cover making the official puppetlabs-mysql usable with the MariaDB official repositories on CentOS. For some completely incomprehensible reason, the official MariaDB RPMs for CentOS6 don’t create the MariaDB folder in \u002Fvar\u002Frun, meaning that we have to crack out a little hack to make the puppetlabs-mysql Puppet module work as it's intended."}]},{type:a,value:h},{type:b,tag:m,props:{},children:[{type:a,value:"The process will cover the following steps:"}]},{type:a,value:h},{type:b,tag:"ul",props:{},children:[{type:b,tag:s,props:{},children:[{type:a,value:"Manage the MariaDB package ourselves"}]},{type:a,value:h},{type:b,tag:s,props:{},children:[{type:a,value:"Manually create the MariaDB rundir"}]},{type:a,value:h},{type:b,tag:s,props:{},children:[{type:a,value:"Ensure proper ownership of the rundir"}]},{type:a,value:h}]},{type:a,value:h},{type:b,tag:m,props:{},children:[{type:a,value:"I'll assume you've already added the MariaDB repository to your copy of CentOS. If not, the "},{type:b,tag:"a",props:{href:"https:\u002F\u002Fdownloads.mariadb.org\u002Fmariadb\u002Frepositories\u002F",target:"_blank"},children:[{type:a,value:"excellent guides on the MariaDB website"}]},{type:a,value:" should be enough to get you started. I'm going to put the code directly into a node classification, but you can do it pretty much anywhere you like. If you need to use this code more than once, consider putting it in a definition or class of its own."}]},{type:a,value:h},{type:b,tag:"div",props:{className:["nuxt-content-highlight"]},children:[{type:b,tag:"pre",props:{className:["language-puppet","line-numbers"]},children:[{type:b,tag:"code",props:{},children:[{type:b,tag:c,props:{className:[d,x]},children:[{type:a,value:"node"}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:"'puppet-mariadb.alexshepherd.me'"}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:q}]},{type:a,value:o},{type:b,tag:c,props:{className:[d,p]},children:[{type:a,value:t}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:i}]},{type:a,value:" ‘MariaDB"},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:u}]},{type:a,value:"Server’\n    "},{type:b,tag:c,props:{className:[d,p]},children:[{type:a,value:y}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:i}]},{type:a,value:" ‘mysql’\n\n    package "},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:q}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,l]},children:[{type:b,tag:c,props:{className:[d,"double-quoted"]},children:[{type:a,value:"\"mysql-server\""}]}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:v}]},{type:a,value:z},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:i}]},{type:a,value:j},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:k}]},{type:a,value:" installed"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:a,value:"\n        name "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:i}]},{type:a,value:j},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:k}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,p]},children:[{type:a,value:t}]},{type:a,value:o},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:r}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:u}]},{type:a,value:j},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:k}]},{type:a,value:"\n    file "},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:q}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:"'mysql_rundir'"}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:v}]},{type:a,value:"\n        path "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:i}]},{type:a,value:j},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:k}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:"'\u002Fvar\u002Frun\u002Fmysqld'"}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:a,value:z},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:i}]},{type:a,value:j},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:k}]},{type:a,value:" directory"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:a,value:"\n        owner "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:i}]},{type:a,value:j},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:k}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:A}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:a,value:"\n        group "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:i}]},{type:a,value:j},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:k}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:A}]},{type:a,value:o},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:r}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:u}]},{type:a,value:j},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:k}]},{type:a,value:o},{type:b,tag:c,props:{className:[d,x]},children:[{type:a,value:"class"}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:q}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:"'::mysql::server'"}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:v}]},{type:a,value:"\n        package_manage "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:i}]},{type:a,value:j},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:k}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,"boolean"]},children:[{type:a,value:"false"}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:a,value:"\n        package_name "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:i}]},{type:a,value:j},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:k}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,p]},children:[{type:a,value:t}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:a,value:"\n        service_name "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:i}]},{type:a,value:j},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:k}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,p]},children:[{type:a,value:y}]},{type:a,value:o},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:r}]},{type:a,value:h},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:r}]},{type:a,value:h}]}]}]},{type:a,value:h},{type:b,tag:m,props:{},children:[{type:a,value:"It is important that we use this exact dependency sequence, and these exact options in order to make it work. Particularly, the puppetlabs-mysql module depends on a package called "},{type:b,tag:B,props:{},children:[{type:a,value:"mysql-server"}]},{type:a,value:", so we alias it using the "},{type:b,tag:B,props:{},children:[{type:a,value:"name"}]},{type:a,value:" attribute on the package resource We also need to include package_name on ::mysql::server, as there are internal dependencies that cause issues if we don't set it, even though we choose specifically not to manage the package with the module."}]},{type:a,value:h},{type:b,tag:m,props:{},children:[{type:a,value:"Puppet, while an amazing tool that solves so many issues, does still feel a little hackish in places, but we wouldn't be managing servers if we minded performing the odd messy hack where appropriate! That's all for today - expect more devops-related posts moving forwards."}]}]},dir:"\u002Fposts",path:"\u002Fposts\u002Fpuppetlabs-puppet-mysql-mariadb-centos",extension:".md",readingStats:{text:"2 min read",minutes:1.645,time:98700,words:329}}}],fetch:{},mutations:void 0}}("text","element","span","token","punctuation"," ","operator","\n","=","&gt",";","string","p",",","\n    ","variable","{","}","li","$mariadb_package_name","-",":","2015-07-12T06:00:00.000Z","keyword","$mariadb_service_name","\n        ensure ","'mysql'","i")));