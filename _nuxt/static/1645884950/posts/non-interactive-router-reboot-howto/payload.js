__NUXT_JSONP__("/posts/non-interactive-router-reboot-howto", (function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D){return {data:[{post:{slug:"non-interactive-router-reboot-howto",description:"How to reboot a home router automatically and\u002For non-interactively",title:"Non-interactive router reboot HOWTO",imagesource:"https:\u002F\u002Fcommons.wikimedia.org\u002Fwiki\u002FFile:WRT54G_v2_Linksys_Router_Digon3.jpg",imagecredit:"Jonathan Zander",image:"2009.04.07T14:00:00_non-interactive-router-reboot-howto.jpg",createdAt:B,updatedAt:B,toc:[],body:{type:"root",children:[{type:b,tag:f,props:{},children:[{type:a,value:"Hi everyone!"}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"I've recently been having trouble with a router getting all bunged up due to the high levels of data passing through it. Invariably, I come in in the morning and we've lost access to the Internet from some of our stations until I've rebooted it. While I'm in the process of building a routing box for the network, I wanted to know if I could automagically have the router reboot itself well before anyone would be wanting access."}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"As with almost EVERYTHING Linux oriented, the answer is OF COURSE I CAN!"}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"There's a nifty little utility within Linux called "},{type:b,tag:h,props:{},children:[{type:a,value:o}]},{type:a,value:". It comes as standard with Slackware, so no installation needed for me. It allows pre-programmed non-interactive access to normally interactive shells. The script I've written looks like this:"}]},{type:a,value:e},{type:b,tag:"div",props:{className:["nuxt-content-highlight"]},children:[{type:b,tag:"pre",props:{className:["language-bash","line-numbers"]},children:[{type:b,tag:"code",props:{},children:[{type:b,tag:c,props:{className:[d,"shebang","important"]},children:[{type:a,value:"#!\u002Fusr\u002Fbin\u002Fexpect -f"}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,q,r]},children:[{type:a,value:s}]},{type:a,value:" address "},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:t}]},{type:a,value:u},{type:b,tag:c,props:{className:[d,j]},children:[{type:a,value:v}]},{type:a,value:k},{type:b,tag:c,props:{className:[d,w]},children:[{type:a,value:"0"}]},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:x}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,q,r]},children:[{type:a,value:s}]},{type:a,value:" username "},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:t}]},{type:a,value:u},{type:b,tag:c,props:{className:[d,j]},children:[{type:a,value:v}]},{type:a,value:k},{type:b,tag:c,props:{className:[d,w]},children:[{type:a,value:"1"}]},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:x}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,q,r]},children:[{type:a,value:s}]},{type:a,value:" password  "},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:t}]},{type:a,value:u},{type:b,tag:c,props:{className:[d,j]},children:[{type:a,value:v}]},{type:a,value:k},{type:b,tag:c,props:{className:[d,w]},children:[{type:a,value:"2"}]},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:x}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,q,r]},children:[{type:a,value:s}]},{type:a,value:" routercmd "},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:t}]},{type:a,value:u},{type:b,tag:c,props:{className:[d,j]},children:[{type:a,value:v}]},{type:a,value:k},{type:b,tag:c,props:{className:[d,w]},children:[{type:a,value:"3"}]},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:x}]},{type:a,value:"\nspawn telnet "},{type:b,tag:c,props:{className:[d,j]},children:[{type:a,value:"$address"}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,y]},children:[{type:a,value:o}]},{type:a,value:k},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:"\"Login:\""}]},{type:a,value:n},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:m},{type:b,tag:c,props:{className:[d,j]},children:[{type:a,value:"$username"}]},{type:b,tag:c,props:{className:[d,z],title:l},children:[{type:a,value:l}]},{type:a,value:m}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,y]},children:[{type:a,value:o}]},{type:a,value:k},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:"\"Password:\""}]},{type:a,value:n},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:m},{type:b,tag:c,props:{className:[d,j]},children:[{type:a,value:"$password"}]},{type:b,tag:c,props:{className:[d,z],title:l},children:[{type:a,value:l}]},{type:a,value:m}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,C]},children:[{type:a,value:"# This command gets us out of the default menu and into a shell"}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,y]},children:[{type:a,value:o}]},{type:a,value:k},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:"\"&amp;gt; \""}]},{type:a,value:n},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:"\"sh"},{type:b,tag:c,props:{className:[d,z],title:l},children:[{type:a,value:l}]},{type:a,value:m}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,y]},children:[{type:a,value:o}]},{type:a,value:k},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:"\"# \""}]},{type:a,value:n},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:m},{type:b,tag:c,props:{className:[d,j]},children:[{type:a,value:"$routercmd"}]},{type:b,tag:c,props:{className:[d,z],title:l},children:[{type:a,value:l}]},{type:a,value:m}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,C]},children:[{type:a,value:"#exit"}]},{type:a,value:n},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:D}]},{type:a,value:n},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:D}]},{type:a,value:e}]}]}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"As you can see, expect is used as the script handler with the -f flag, which would usually point to a script file to be run."}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"The script really is incredibly simple..."}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"It takes 4 arguments in this order:"},{type:b,tag:p,props:{},children:[]},{type:b,tag:h,props:{},children:[{type:a,value:"address"}]},{type:a,value:" - The router's IP,"},{type:b,tag:p,props:{},children:[]},{type:b,tag:h,props:{},children:[{type:a,value:"username"}]},{type:a,value:" - The router's admin username"},{type:b,tag:p,props:{},children:[]},{type:b,tag:h,props:{},children:[{type:a,value:"password"}]},{type:a,value:" - The router's admin password"},{type:b,tag:p,props:{},children:[]},{type:b,tag:h,props:{},children:[{type:a,value:"routercmd"}]},{type:a,value:" - The command which you wish to run"}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"In my case, I've set up a cron job to run daily at 4.40am (the default for cron.daily) which runs the command "},{type:b,tag:h,props:{},children:[{type:a,value:"\u002Fusr\u002Flocal\u002Fbin\u002Froutercommand.exp 192.168.1.1 **username** **password** reboot"}]},{type:a,value:". I am yet to see whether 4.40am is suitable, but it's a step in the right direction!"}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Anyway, I hope this has been of interest or maybe even use!"}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:A},{type:b,tag:p,props:{},children:[]},{type:b,tag:h,props:{},children:[{type:a,value:"UPDATE - 09\u002F04\u002F09"}]}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"This has completely fixed our problems with the router. We have seen flawless behaviour since. Whoo! Now if I could only get Smoothwall doing PPPoA with the router in bridge mode! Any ideas would be very helpful!"}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:A}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:b,tag:h,props:{},children:[{type:a,value:"UPDATE - 24\u002F04\u002F09"}]}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"It seems that all of these modem\u002Frouters which claim to fully support bridge mode are at best exaggerating. The best results it is apparent that you can expect is intermittency, which is TOTALLY USELESS in a production environment. The way forward is using a true PPPoA to PPPoE bridge modem. I'm using a Draytek Vigor 110, because by all accounts it ACTUALLY WORKS (shock, horror!)."}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Anyway... Just thought I'd feed you all that useful little nugget of knowledge. Hopefully I've saved even one person from losing sleep over it."}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:A}]}]},dir:"\u002Fposts",path:"\u002Fposts\u002Fnon-interactive-router-reboot-howto",extension:".md",readingStats:{text:"3 min read",minutes:2.26,time:135600,words:452},postedAgo:"13 years ago"}}],fetch:{},mutations:void 0}}("text","element","span","token","\n","p","string","strong","punctuation","variable"," ","\\r","\"","\nsend -- ","expect","br","builtin","class-name","set","[","lindex ","$argv","number","]","function","entity","n00b","2009-04-07T14:00:00.000Z","comment","\"^D\"")));