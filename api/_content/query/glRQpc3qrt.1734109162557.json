{"_path":"/posts/slackware-bootsplash-howto","_dir":"posts","_draft":false,"_partial":false,"_locale":"","title":"Slackware Bootsplash Howto","description":"One of the few Slackware Bootsplash patch guides available online.","imagesource":"https://www.flickr.com/photos/128655137@N02/21647362778","imagecredit":"Pierre Vaast","image":"2009.02.03T150000_slackware-bootsplash-howto.jpg","createdAt":"2009-02-03T15:00:00","updatedAt":"2009-02-03T15:00:00","readingTime":{"text":"1 min read","minutes":0.36,"time":21600,"words":72},"body":{"type":"root","children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Hi all. I don't know about any of you, but the fact that the original bootsplash patch is becoming obsolete and being superceded by sucky... sorry, I mean splashy... really pisses me off. I love the simplicity and speed of bootsplash, and splashy has failed to deliver on almost every front. It's slow, ungraceful, difficult to make really pretty, and what annoys me more than anything is that the verbose mode is utter crap. Kernel panics will never be easy to diagnose again."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"I don't install bootsplash often enough to know it off by heart, and I find that every time I install Slackware on a new system I want to put a bootsplash on I can never exactly remember how -- cue many frustrating wasted hours trying to get it sorted. I'd imagine it's a problem that I'm not alone in encountering, so for your intellectual enjoyment (and hopefully to help retain your hair's colour!), here's a full howto."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"NB: If you are a newbie to compiling kernels, creating initramfs images and reconfiguring LILO, then consider seriously practising/reading up on them before attempting this, as you could render your system unbootable."}]},{"type":"element","tag":"h1","props":{"id":"step-1-patch-configure-and-install-the-kernel"},"children":[{"type":"text","value":"Step 1: Patch, configure and install the kernel."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"You'll need a working patch for the kernel you're using. Sometimes a patch from a previous kernel will work, but always patch with the following tags first:"}]},{"type":"element","tag":"pre","props":{"className":"language-bash shiki shiki-themes github-dark","code":"patch --dry-run -p1 &lt; bootsplash-3.1.6-$(uname -r)\n","language":"bash","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#B392F0"},"children":[{"type":"text","value":"patch"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" --dry-run"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" -p1"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8"},"children":[{"type":"text","value":" &"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B392F0"},"children":[{"type":"text","value":"lt"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8"},"children":[{"type":"text","value":"; "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B392F0"},"children":[{"type":"text","value":"bootsplash-3.1.6-$(uname"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" -r"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8"},"children":[{"type":"text","value":")\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"This will just test the patch. If you get any HUNK FAILED messages, then DON'T USE IT! Also, if you are trying a patch from a different kernel, then replace $(uname -r) with the patch's kernel version."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"You will now need to configure the kernel using your favourite .config editor. I'm a huge fan of xconfig (type "},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"make xconfig"}]},{"type":"text","value":" in your kernel's unpacked directory). You will need to turn OFF the existing bootup logo and turn on the bootup splash screen. It's probably a good idea to make sure you have initrd/initramfs support in there too."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Now compile and install your kernel. If you don't know how to do this, Eric Hameleers (Alien Bob) has written an "},{"type":"element","tag":"a","props":{"href":"http://alien.slackbook.org/dokuwiki/doku.php?id=linux:kernelbuilding&s%5B%5D=kernel&s%5B%5D=compile"},"children":[{"type":"text","value":"excellent guide"}]},{"type":"text","value":" on "},{"type":"element","tag":"a","props":{"href":"http://alien.slackbook.org/dokuwiki/doku.php"},"children":[{"type":"text","value":"his Dokuwiki"}]},{"type":"text","value":". Take heed of all of his warnings, as doing this wrong could hose your computer. See you after the KERNEL PANIC."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Now boot up your new kernel."}]},{"type":"element","tag":"h1","props":{"id":"step-2-download-compile-and-install-the-splash-util"},"children":[{"type":"text","value":"Step 2: Download, compile and install the splash util."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"There are countless copies of the splash utilities scattered around the internet, and the places you'll find them change regularly, so I can't give you a direct link, but version 3.0.7 seems to be a pretty good bet, and easy to find."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Once you have downloaded the package, just typing "},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"make"}]},{"type":"text","value":" will result in a huge b0rk-fest. The only binary you need is splash, so just type "},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"make splash"}]},{"type":"text","value":", and you should be ok. Now copy this into /sbin and that's step 2 complete."}]},{"type":"element","tag":"h1","props":{"id":"step-3-make-your-initramfs-format-initrdgz"},"children":[{"type":"text","value":"Step 3: Make your initramfs format initrd.gz"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"I find this is where the guides all start to tell fibs. They all tell you just to use the splash binary and redirect the output to a file. THIS DOES "},{"type":"element","tag":"em","props":{},"children":[{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"NOT"}]}]},{"type":"text","value":" WORK. The reason being that Slackware now uses an initramfs image for it's initial ramdisk, which is a compressed cpio archive. Just using this file will not be recognised, and annoyingly there will be no useful pointers to show you what's wrong."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"First off, you'll want to download a bootsplash from somewhere. "},{"type":"element","tag":"a","props":{"href":"http://www.kde-look.org"},"children":[{"type":"text","value":"Kde-look"}]},{"type":"text","value":" has some pretty nifty ones. Now create the directory /etc/bootsplash/themes. Put the files you downloaded in here in the format /etc/bootsplash/themes/"},{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"theme-name"}]},{"type":"text","value":"/images and themes/"},{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"theme-name"}]},{"type":"text","value":"/config."}]},{"type":"element","tag":"h3","props":{"id":"update-872011"},"children":[{"type":"element","tag":"span","props":{"style":"color:#ff0000;"},"children":[{"type":"text","value":"UPDATE (8/7/2011):"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"If you are creating your own images to use as a bootsplash, you will need to make sure that they must be in YCbCr 221111 JPEG format, which means that they must use the JPEG file format, YCbCr color space, and subsampling must be set to 2x2, 1x1, 1x1. This is achieved in GIMP by choosing JPG format, and then under "},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"Advanced Options"}]},{"type":"text","value":", selecting "},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"2x2, 1x1, 1x1 (smallest file)"}]},{"type":"text","value":" from the "},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"Subsampling"}]},{"type":"text","value":" drop down box. Simple when you know how!"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Now to actually create the initramfs. First of all, check for the existence of a file called initrd.gz in your /boot folder. If there is one there, then you should back it up before proceeding, as it will now be blown away. Navigate to /boot and type:"}]},{"type":"element","tag":"pre","props":{"className":"language-bash shiki shiki-themes github-dark","code":"mkinitrd -c -k $(uname -r) -f filesystemtype -r /dev/rootpartition\n","language":"bash","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#B392F0"},"children":[{"type":"text","value":"mkinitrd"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" -c"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" -k"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8"},"children":[{"type":"text","value":" $("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B392F0"},"children":[{"type":"text","value":"uname"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" -r"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8"},"children":[{"type":"text","value":") "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":"-f"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF"},"children":[{"type":"text","value":" filesystemtype"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" -r"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF"},"children":[{"type":"text","value":" /dev/rootpartition\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Just replace filesystemtype with your fs (e.g., ext3/ext4/reiserfs), and rootpartition with the / partition of your machine (e.g., sda1, sda7)"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"There will now be a folder called initrd-tree in /boot. This will be the contents of your initrd. Navigate to this folder and use the following command:"}]},{"type":"element","tag":"pre","props":{"className":"language-bash shiki shiki-themes github-dark","code":"splash -s -f /etc/bootsplash/themes/{THEME_NAME}/config/bootsplash-1024x768.cfg &gt; bootsplash\n","language":"bash","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#B392F0"},"children":[{"type":"text","value":"splash"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" -s"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" -f"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF"},"children":[{"type":"text","value":" /etc/bootsplash/themes/{THEME_NAME}/config/bootsplash-1024x768.cfg"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8"},"children":[{"type":"text","value":" &"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B392F0"},"children":[{"type":"text","value":"gt"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8"},"children":[{"type":"text","value":"; "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B392F0"},"children":[{"type":"text","value":"bootsplash\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"This has placed some information for the kernel on the location of the bootsplash theme in the cpio archive. You now need to place the bootsplash into the folder in exactly the same directory structure that exists on your filesystem. Create the folder /boot/initrd-tree/etc/bootsplash/themes and copy in the bootsplash theme you downloaded and installed earlier."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"To finish off our penultimate step, go to /boot again and type simply "},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"mkinitrd"}]},{"type":"text","value":" to compress the contents of /boot/initrd-tree into the initrd.gz file you will now see in the /boot folder."}]},{"type":"element","tag":"h1","props":{"id":"step-4-reconfigure-lilo-and-reboot"},"children":[{"type":"text","value":"Step 4: Reconfigure LILO and reboot."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Ok, we've got to the point of no return. You have a working bootsplash enabled kernel and a brilliantly put together initramfs image. Now you'll need to modify the /etc/lilo.conf section which points at your new kernel as follows:"}]},{"type":"element","tag":"pre","props":{"className":"language-bash shiki shiki-themes github-dark","code":"image = /boot/vmlinuz-custom-2.6.27.7-1 # Or whatever your kernel image is called\nroot = /dev/hda7 # Or whatever your root partition is.\nlabel = Slacksplash # Name it anything you like\ninitrd = /boot/initrd.gz\nappend = \"splash=silent\"\nread-only\n","language":"bash","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#B392F0"},"children":[{"type":"text","value":"image"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF"},"children":[{"type":"text","value":" ="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF"},"children":[{"type":"text","value":" /boot/vmlinuz-custom-2.6.27.7-1"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#6A737D"},"children":[{"type":"text","value":" # Or whatever your kernel image is called\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#B392F0"},"children":[{"type":"text","value":"root"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF"},"children":[{"type":"text","value":" ="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF"},"children":[{"type":"text","value":" /dev/hda7"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#6A737D"},"children":[{"type":"text","value":" # Or whatever your root partition is.\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#B392F0"},"children":[{"type":"text","value":"label"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF"},"children":[{"type":"text","value":" ="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF"},"children":[{"type":"text","value":" Slacksplash"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#6A737D"},"children":[{"type":"text","value":" # Name it anything you like\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#B392F0"},"children":[{"type":"text","value":"initrd"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF"},"children":[{"type":"text","value":" ="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF"},"children":[{"type":"text","value":" /boot/initrd.gz\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#B392F0"},"children":[{"type":"text","value":"append"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF"},"children":[{"type":"text","value":" ="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF"},"children":[{"type":"text","value":" \"splash=silent\"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#B392F0"},"children":[{"type":"text","value":"read-only\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"You will also need to configure LILO to boot in the screen mode for whichever resolution and bit depth the splash image is in. You can find a list of VESA screen modes "},{"type":"element","tag":"a","props":{"href":"http://wiki.antlinux.com/pmwiki.php?n=HowTos.VgaModes"},"children":[{"type":"text","value":"here"}]},{"type":"text","value":". You can either use the decimal or hexadecimal values. Lilo will understand both, but make sure you prefix the hexadecimal number with 0x... Here is an example:"}]},{"type":"element","tag":"pre","props":{"className":"language-bash shiki shiki-themes github-dark","code":"# First of all in decimal:\nvga=791\n# This is the same as the following in hexadecimal:\nvga=0x317\n","language":"bash","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#6A737D"},"children":[{"type":"text","value":"# First of all in decimal:\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8"},"children":[{"type":"text","value":"vga"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F97583"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF"},"children":[{"type":"text","value":"791\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#6A737D"},"children":[{"type":"text","value":"# This is the same as the following in hexadecimal:\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8"},"children":[{"type":"text","value":"vga"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F97583"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF"},"children":[{"type":"text","value":"0x317\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"If you get the screen depth wrong, all will appear to go fine, but you won't get a splash image. I have to fiddle with this almost every time I apply a bootsplash!"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Once you've got it configured, run lilo. I tend to use "},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"lilo -c -v"}]},{"type":"text","value":" as -c speeds up the initial loading of the kernel (compact mode), and -v gives you a whole bunch of useful information to help troubleshoot any problems."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Now reboot, select your kernel from the list and admire all the beautiful colours swirling across your screen."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"That's it... Done. Any questions just leave me a comment."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"n00b"}]},{"type":"element","tag":"style","props":{},"children":[{"type":"text","value":"html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}"}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[{"id":"update-872011","depth":3,"text":"UPDATE (8/7/2011):"}]}},"_type":"markdown","_id":"content:posts:2009-02-03-slackware-bootsplash-howto.md","_source":"content","_file":"posts/2009-02-03-slackware-bootsplash-howto.md","_stem":"posts/2009-02-03-slackware-bootsplash-howto","_extension":"md"}